var En=Object.defineProperty;var Mn=(n,t,i)=>t in n?En(n,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):n[t]=i;var Y=(n,t,i)=>Mn(n,typeof t!="symbol"?t+"":t,i);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const f of document.querySelectorAll('link[rel="modulepreload"]'))d(f);new MutationObserver(f=>{for(const g of f)if(g.type==="childList")for(const b of g.addedNodes)b.tagName==="LINK"&&b.rel==="modulepreload"&&d(b)}).observe(document,{childList:!0,subtree:!0});function i(f){const g={};return f.integrity&&(g.integrity=f.integrity),f.referrerPolicy&&(g.referrerPolicy=f.referrerPolicy),f.crossOrigin==="use-credentials"?g.credentials="include":f.crossOrigin==="anonymous"?g.credentials="omit":g.credentials="same-origin",g}function d(f){if(f.ep)return;f.ep=!0;const g=i(f);fetch(f.href,g)}})();function Dn(n){if(!(typeof window>"u")){var t=document.createElement("style");return t.setAttribute("type","text/css"),t.innerHTML=n,document.head.appendChild(t),n}}function te(n,t){var i=n.__state.conversionName.toString(),d=Math.round(n.r),f=Math.round(n.g),g=Math.round(n.b),b=n.a,M=Math.round(n.h),k=n.s.toFixed(1),A=n.v.toFixed(1);if(t||i==="THREE_CHAR_HEX"||i==="SIX_CHAR_HEX"){for(var T=n.hex.toString(16);T.length<6;)T="0"+T;return"#"+T}else{if(i==="CSS_RGB")return"rgb("+d+","+f+","+g+")";if(i==="CSS_RGBA")return"rgba("+d+","+f+","+g+","+b+")";if(i==="HEX")return"0x"+n.hex.toString(16);if(i==="RGB_ARRAY")return"["+d+","+f+","+g+"]";if(i==="RGBA_ARRAY")return"["+d+","+f+","+g+","+b+"]";if(i==="RGB_OBJ")return"{r:"+d+",g:"+f+",b:"+g+"}";if(i==="RGBA_OBJ")return"{r:"+d+",g:"+f+",b:"+g+",a:"+b+"}";if(i==="HSV_OBJ")return"{h:"+M+",s:"+k+",v:"+A+"}";if(i==="HSVA_OBJ")return"{h:"+M+",s:"+k+",v:"+A+",a:"+b+"}"}return"unknown format"}var Ve=Array.prototype.forEach,ee=Array.prototype.slice,C={BREAK:{},extend:function(t){return this.each(ee.call(arguments,1),function(i){var d=this.isObject(i)?Object.keys(i):[];d.forEach((function(f){this.isUndefined(i[f])||(t[f]=i[f])}).bind(this))},this),t},defaults:function(t){return this.each(ee.call(arguments,1),function(i){var d=this.isObject(i)?Object.keys(i):[];d.forEach((function(f){this.isUndefined(t[f])&&(t[f]=i[f])}).bind(this))},this),t},compose:function(){var t=ee.call(arguments);return function(){for(var i=ee.call(arguments),d=t.length-1;d>=0;d--)i=[t[d].apply(this,i)];return i[0]}},each:function(t,i,d){if(t){if(Ve&&t.forEach&&t.forEach===Ve)t.forEach(i,d);else if(t.length===t.length+0){var f=void 0,g=void 0;for(f=0,g=t.length;f<g;f++)if(f in t&&i.call(d,t[f],f)===this.BREAK)return}else for(var b in t)if(i.call(d,t[b],b)===this.BREAK)return}},defer:function(t){setTimeout(t,0)},debounce:function(t,i,d){var f=void 0;return function(){var g=this,b=arguments;function M(){f=null,d||t.apply(g,b)}var k=d||!f;clearTimeout(f),f=setTimeout(M,i),k&&t.apply(g,b)}},toArray:function(t){return t.toArray?t.toArray():ee.call(t)},isUndefined:function(t){return t===void 0},isNull:function(t){return t===null},isNaN:function(n){function t(i){return n.apply(this,arguments)}return t.toString=function(){return n.toString()},t}(function(n){return isNaN(n)}),isArray:Array.isArray||function(n){return n.constructor===Array},isObject:function(t){return t===Object(t)},isNumber:function(t){return t===t+0},isString:function(t){return t===t+""},isBoolean:function(t){return t===!1||t===!0},isFunction:function(t){return t instanceof Function}},An=[{litmus:C.isString,conversions:{THREE_CHAR_HEX:{read:function(t){var i=t.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);return i===null?!1:{space:"HEX",hex:parseInt("0x"+i[1].toString()+i[1].toString()+i[2].toString()+i[2].toString()+i[3].toString()+i[3].toString(),0)}},write:te},SIX_CHAR_HEX:{read:function(t){var i=t.match(/^#([A-F0-9]{6})$/i);return i===null?!1:{space:"HEX",hex:parseInt("0x"+i[1].toString(),0)}},write:te},CSS_RGB:{read:function(t){var i=t.match(/^rgb\(\s*(\S+)\s*,\s*(\S+)\s*,\s*(\S+)\s*\)/);return i===null?!1:{space:"RGB",r:parseFloat(i[1]),g:parseFloat(i[2]),b:parseFloat(i[3])}},write:te},CSS_RGBA:{read:function(t){var i=t.match(/^rgba\(\s*(\S+)\s*,\s*(\S+)\s*,\s*(\S+)\s*,\s*(\S+)\s*\)/);return i===null?!1:{space:"RGB",r:parseFloat(i[1]),g:parseFloat(i[2]),b:parseFloat(i[3]),a:parseFloat(i[4])}},write:te}}},{litmus:C.isNumber,conversions:{HEX:{read:function(t){return{space:"HEX",hex:t,conversionName:"HEX"}},write:function(t){return t.hex}}}},{litmus:C.isArray,conversions:{RGB_ARRAY:{read:function(t){return t.length!==3?!1:{space:"RGB",r:t[0],g:t[1],b:t[2]}},write:function(t){return[t.r,t.g,t.b]}},RGBA_ARRAY:{read:function(t){return t.length!==4?!1:{space:"RGB",r:t[0],g:t[1],b:t[2],a:t[3]}},write:function(t){return[t.r,t.g,t.b,t.a]}}}},{litmus:C.isObject,conversions:{RGBA_OBJ:{read:function(t){return C.isNumber(t.r)&&C.isNumber(t.g)&&C.isNumber(t.b)&&C.isNumber(t.a)?{space:"RGB",r:t.r,g:t.g,b:t.b,a:t.a}:!1},write:function(t){return{r:t.r,g:t.g,b:t.b,a:t.a}}},RGB_OBJ:{read:function(t){return C.isNumber(t.r)&&C.isNumber(t.g)&&C.isNumber(t.b)?{space:"RGB",r:t.r,g:t.g,b:t.b}:!1},write:function(t){return{r:t.r,g:t.g,b:t.b}}},HSVA_OBJ:{read:function(t){return C.isNumber(t.h)&&C.isNumber(t.s)&&C.isNumber(t.v)&&C.isNumber(t.a)?{space:"HSV",h:t.h,s:t.s,v:t.v,a:t.a}:!1},write:function(t){return{h:t.h,s:t.s,v:t.v,a:t.a}}},HSV_OBJ:{read:function(t){return C.isNumber(t.h)&&C.isNumber(t.s)&&C.isNumber(t.v)?{space:"HSV",h:t.h,s:t.s,v:t.v}:!1},write:function(t){return{h:t.h,s:t.s,v:t.v}}}}}],ne=void 0,pe=void 0,De=function(){pe=!1;var t=arguments.length>1?C.toArray(arguments):arguments[0];return C.each(An,function(i){if(i.litmus(t))return C.each(i.conversions,function(d,f){if(ne=d.read(t),pe===!1&&ne!==!1)return pe=ne,ne.conversionName=f,ne.conversion=d,C.BREAK}),C.BREAK}),pe},Ge=void 0,ge={hsv_to_rgb:function(t,i,d){var f=Math.floor(t/60)%6,g=t/60-Math.floor(t/60),b=d*(1-i),M=d*(1-g*i),k=d*(1-(1-g)*i),A=[[d,k,b],[M,d,b],[b,d,k],[b,M,d],[k,b,d],[d,b,M]][f];return{r:A[0]*255,g:A[1]*255,b:A[2]*255}},rgb_to_hsv:function(t,i,d){var f=Math.min(t,i,d),g=Math.max(t,i,d),b=g-f,M=void 0,k=void 0;if(g!==0)k=b/g;else return{h:NaN,s:0,v:0};return t===g?M=(i-d)/b:i===g?M=2+(d-t)/b:M=4+(t-i)/b,M/=6,M<0&&(M+=1),{h:M*360,s:k,v:g/255}},rgb_to_hex:function(t,i,d){var f=this.hex_with_component(0,2,t);return f=this.hex_with_component(f,1,i),f=this.hex_with_component(f,0,d),f},component_from_hex:function(t,i){return t>>i*8&255},hex_with_component:function(t,i,d){return d<<(Ge=i*8)|t&~(255<<Ge)}},Sn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},$t=function(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")},qt=function(){function n(t,i){for(var d=0;d<i.length;d++){var f=i[d];f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(t,f.key,f)}}return function(t,i,d){return i&&n(t.prototype,i),d&&n(t,d),t}}(),Yt=function n(t,i,d){t===null&&(t=Function.prototype);var f=Object.getOwnPropertyDescriptor(t,i);if(f===void 0){var g=Object.getPrototypeOf(t);return g===null?void 0:n(g,i,d)}else{if("value"in f)return f.value;var b=f.get;return b===void 0?void 0:b.call(d)}},Wt=function(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)},Kt=function(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n},Pt=function(){function n(){if($t(this,n),this.__state=De.apply(this,arguments),this.__state===!1)throw new Error("Failed to interpret color arguments");this.__state.a=this.__state.a||1}return qt(n,[{key:"toString",value:function(){return te(this)}},{key:"toHexString",value:function(){return te(this,!0)}},{key:"toOriginal",value:function(){return this.__state.conversion.write(this)}}]),n}();function ke(n,t,i){Object.defineProperty(n,t,{get:function(){return this.__state.space==="RGB"?this.__state[t]:(Pt.recalculateRGB(this,t,i),this.__state[t])},set:function(f){this.__state.space!=="RGB"&&(Pt.recalculateRGB(this,t,i),this.__state.space="RGB"),this.__state[t]=f}})}function ze(n,t){Object.defineProperty(n,t,{get:function(){return this.__state.space==="HSV"?this.__state[t]:(Pt.recalculateHSV(this),this.__state[t])},set:function(d){this.__state.space!=="HSV"&&(Pt.recalculateHSV(this),this.__state.space="HSV"),this.__state[t]=d}})}Pt.recalculateRGB=function(n,t,i){if(n.__state.space==="HEX")n.__state[t]=ge.component_from_hex(n.__state.hex,i);else if(n.__state.space==="HSV")C.extend(n.__state,ge.hsv_to_rgb(n.__state.h,n.__state.s,n.__state.v));else throw new Error("Corrupted color state")};Pt.recalculateHSV=function(n){var t=ge.rgb_to_hsv(n.r,n.g,n.b);C.extend(n.__state,{s:t.s,v:t.v}),C.isNaN(t.h)?C.isUndefined(n.__state.h)&&(n.__state.h=0):n.__state.h=t.h};Pt.COMPONENTS=["r","g","b","h","s","v","hex","a"];ke(Pt.prototype,"r",2);ke(Pt.prototype,"g",1);ke(Pt.prototype,"b",0);ze(Pt.prototype,"h");ze(Pt.prototype,"s");ze(Pt.prototype,"v");Object.defineProperty(Pt.prototype,"a",{get:function(){return this.__state.a},set:function(t){this.__state.a=t}});Object.defineProperty(Pt.prototype,"hex",{get:function(){return this.__state.space!=="HEX"&&(this.__state.hex=ge.rgb_to_hex(this.r,this.g,this.b),this.__state.space="HEX"),this.__state.hex},set:function(t){this.__state.space="HEX",this.__state.hex=t}});var Zt=function(){function n(t,i){$t(this,n),this.initialValue=t[i],this.domElement=document.createElement("div"),this.object=t,this.property=i,this.__onChange=void 0,this.__onFinishChange=void 0}return qt(n,[{key:"onChange",value:function(i){return this.__onChange=i,this}},{key:"onFinishChange",value:function(i){return this.__onFinishChange=i,this}},{key:"setValue",value:function(i){return this.object[this.property]=i,this.__onChange&&this.__onChange.call(this,i),this.updateDisplay(),this}},{key:"getValue",value:function(){return this.object[this.property]}},{key:"updateDisplay",value:function(){return this}},{key:"isModified",value:function(){return this.initialValue!==this.getValue()}}]),n}(),Pn={HTMLEvents:["change"],MouseEvents:["click","mousemove","mousedown","mouseup","mouseover"],KeyboardEvents:["keydown"]},cn={};C.each(Pn,function(n,t){C.each(n,function(i){cn[i]=t})});var Tn=/(\d+(\.\d+)?)px/;function Xt(n){if(n==="0"||C.isUndefined(n))return 0;var t=n.match(Tn);return C.isNull(t)?0:parseFloat(t[1])}var S={makeSelectable:function(t,i){t===void 0||t.style===void 0||(t.onselectstart=i?function(){return!1}:function(){},t.style.MozUserSelect=i?"auto":"none",t.style.KhtmlUserSelect=i?"auto":"none",t.unselectable=i?"on":"off")},makeFullscreen:function(t,i,d){var f=d,g=i;C.isUndefined(g)&&(g=!0),C.isUndefined(f)&&(f=!0),t.style.position="absolute",g&&(t.style.left=0,t.style.right=0),f&&(t.style.top=0,t.style.bottom=0)},fakeEvent:function(t,i,d,f){var g=d||{},b=cn[i];if(!b)throw new Error("Event type "+i+" not supported.");var M=document.createEvent(b);switch(b){case"MouseEvents":{var k=g.x||g.clientX||0,A=g.y||g.clientY||0;M.initMouseEvent(i,g.bubbles||!1,g.cancelable||!0,window,g.clickCount||1,0,0,k,A,!1,!1,!1,!1,0,null);break}case"KeyboardEvents":{var T=M.initKeyboardEvent||M.initKeyEvent;C.defaults(g,{cancelable:!0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,keyCode:void 0,charCode:void 0}),T(i,g.bubbles||!1,g.cancelable,window,g.ctrlKey,g.altKey,g.shiftKey,g.metaKey,g.keyCode,g.charCode);break}default:{M.initEvent(i,g.bubbles||!1,g.cancelable||!0);break}}C.defaults(M,f),t.dispatchEvent(M)},bind:function(t,i,d,f){var g=f||!1;return t.addEventListener?t.addEventListener(i,d,g):t.attachEvent&&t.attachEvent("on"+i,d),S},unbind:function(t,i,d,f){var g=f||!1;return t.removeEventListener?t.removeEventListener(i,d,g):t.detachEvent&&t.detachEvent("on"+i,d),S},addClass:function(t,i){if(t.className===void 0)t.className=i;else if(t.className!==i){var d=t.className.split(/ +/);d.indexOf(i)===-1&&(d.push(i),t.className=d.join(" ").replace(/^\s+/,"").replace(/\s+$/,""))}return S},removeClass:function(t,i){if(i)if(t.className===i)t.removeAttribute("class");else{var d=t.className.split(/ +/),f=d.indexOf(i);f!==-1&&(d.splice(f,1),t.className=d.join(" "))}else t.className=void 0;return S},hasClass:function(t,i){return new RegExp("(?:^|\\s+)"+i+"(?:\\s+|$)").test(t.className)||!1},getWidth:function(t){var i=getComputedStyle(t);return Xt(i["border-left-width"])+Xt(i["border-right-width"])+Xt(i["padding-left"])+Xt(i["padding-right"])+Xt(i.width)},getHeight:function(t){var i=getComputedStyle(t);return Xt(i["border-top-width"])+Xt(i["border-bottom-width"])+Xt(i["padding-top"])+Xt(i["padding-bottom"])+Xt(i.height)},getOffset:function(t){var i=t,d={left:0,top:0};if(i.offsetParent)do d.left+=i.offsetLeft,d.top+=i.offsetTop,i=i.offsetParent;while(i);return d},isActive:function(t){return t===document.activeElement&&(t.type||t.href)}},an=function(n){Wt(t,n);function t(i,d){$t(this,t);var f=Kt(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,i,d)),g=f;f.__prev=f.getValue(),f.__checkbox=document.createElement("input"),f.__checkbox.setAttribute("type","checkbox");function b(){g.setValue(!g.__prev)}return S.bind(f.__checkbox,"change",b,!1),f.domElement.appendChild(f.__checkbox),f.updateDisplay(),f}return qt(t,[{key:"setValue",value:function(d){var f=Yt(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"setValue",this).call(this,d);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),this.__prev=this.getValue(),f}},{key:"updateDisplay",value:function(){return this.getValue()===!0?(this.__checkbox.setAttribute("checked","checked"),this.__checkbox.checked=!0,this.__prev=!0):(this.__checkbox.checked=!1,this.__prev=!1),Yt(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updateDisplay",this).call(this)}}]),t}(Zt),On=function(n){Wt(t,n);function t(i,d,f){$t(this,t);var g=Kt(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,i,d)),b=f,M=g;if(g.__select=document.createElement("select"),C.isArray(b)){var k={};C.each(b,function(A){k[A]=A}),b=k}return C.each(b,function(A,T){var P=document.createElement("option");P.innerHTML=T,P.setAttribute("value",A),M.__select.appendChild(P)}),g.updateDisplay(),S.bind(g.__select,"change",function(){var A=this.options[this.selectedIndex].value;M.setValue(A)}),g.domElement.appendChild(g.__select),g}return qt(t,[{key:"setValue",value:function(d){var f=Yt(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"setValue",this).call(this,d);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),f}},{key:"updateDisplay",value:function(){return S.isActive(this.__select)?this:(this.__select.value=this.getValue(),Yt(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updateDisplay",this).call(this))}}]),t}(Zt),kn=function(n){Wt(t,n);function t(i,d){$t(this,t);var f=Kt(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,i,d)),g=f;function b(){g.setValue(g.__input.value)}function M(){g.__onFinishChange&&g.__onFinishChange.call(g,g.getValue())}return f.__input=document.createElement("input"),f.__input.setAttribute("type","text"),S.bind(f.__input,"keyup",b),S.bind(f.__input,"change",b),S.bind(f.__input,"blur",M),S.bind(f.__input,"keydown",function(k){k.keyCode===13&&this.blur()}),f.updateDisplay(),f.domElement.appendChild(f.__input),f}return qt(t,[{key:"updateDisplay",value:function(){return S.isActive(this.__input)||(this.__input.value=this.getValue()),Yt(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updateDisplay",this).call(this)}}]),t}(Zt);function He(n){var t=n.toString();return t.indexOf(".")>-1?t.length-t.indexOf(".")-1:0}var un=function(n){Wt(t,n);function t(i,d,f){$t(this,t);var g=Kt(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,i,d)),b=f||{};return g.__min=b.min,g.__max=b.max,g.__step=b.step,C.isUndefined(g.__step)?g.initialValue===0?g.__impliedStep=1:g.__impliedStep=Math.pow(10,Math.floor(Math.log(Math.abs(g.initialValue))/Math.LN10))/10:g.__impliedStep=g.__step,g.__precision=He(g.__impliedStep),g}return qt(t,[{key:"setValue",value:function(d){var f=d;return this.__min!==void 0&&f<this.__min?f=this.__min:this.__max!==void 0&&f>this.__max&&(f=this.__max),this.__step!==void 0&&f%this.__step!==0&&(f=Math.round(f/this.__step)*this.__step),Yt(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"setValue",this).call(this,f)}},{key:"min",value:function(d){return this.__min=d,this}},{key:"max",value:function(d){return this.__max=d,this}},{key:"step",value:function(d){return this.__step=d,this.__impliedStep=d,this.__precision=He(d),this}}]),t}(Zt);function zn(n,t){var i=Math.pow(10,t);return Math.round(n*i)/i}var me=function(n){Wt(t,n);function t(i,d,f){$t(this,t);var g=Kt(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,i,d,f));g.__truncationSuspended=!1;var b=g,M=void 0;function k(){var F=parseFloat(b.__input.value);C.isNaN(F)||b.setValue(F)}function A(){b.__onFinishChange&&b.__onFinishChange.call(b,b.getValue())}function T(){A()}function P(F){var L=M-F.clientY;b.setValue(b.getValue()+L*b.__impliedStep),M=F.clientY}function B(){S.unbind(window,"mousemove",P),S.unbind(window,"mouseup",B),A()}function U(F){S.bind(window,"mousemove",P),S.bind(window,"mouseup",B),M=F.clientY}return g.__input=document.createElement("input"),g.__input.setAttribute("type","text"),S.bind(g.__input,"change",k),S.bind(g.__input,"blur",T),S.bind(g.__input,"mousedown",U),S.bind(g.__input,"keydown",function(F){F.keyCode===13&&(b.__truncationSuspended=!0,this.blur(),b.__truncationSuspended=!1,A())}),g.updateDisplay(),g.domElement.appendChild(g.__input),g}return qt(t,[{key:"updateDisplay",value:function(){return this.__input.value=this.__truncationSuspended?this.getValue():zn(this.getValue(),this.__precision),Yt(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updateDisplay",this).call(this)}}]),t}(un);function $e(n,t,i,d,f){return d+(f-d)*((n-t)/(i-t))}var Ae=function(n){Wt(t,n);function t(i,d,f,g,b){$t(this,t);var M=Kt(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,i,d,{min:f,max:g,step:b})),k=M;M.__background=document.createElement("div"),M.__foreground=document.createElement("div"),S.bind(M.__background,"mousedown",A),S.bind(M.__background,"touchstart",B),S.addClass(M.__background,"slider"),S.addClass(M.__foreground,"slider-fg");function A(L){document.activeElement.blur(),S.bind(window,"mousemove",T),S.bind(window,"mouseup",P),T(L)}function T(L){L.preventDefault();var G=k.__background.getBoundingClientRect();return k.setValue($e(L.clientX,G.left,G.right,k.__min,k.__max)),!1}function P(){S.unbind(window,"mousemove",T),S.unbind(window,"mouseup",P),k.__onFinishChange&&k.__onFinishChange.call(k,k.getValue())}function B(L){L.touches.length===1&&(S.bind(window,"touchmove",U),S.bind(window,"touchend",F),U(L))}function U(L){var G=L.touches[0].clientX,K=k.__background.getBoundingClientRect();k.setValue($e(G,K.left,K.right,k.__min,k.__max))}function F(){S.unbind(window,"touchmove",U),S.unbind(window,"touchend",F),k.__onFinishChange&&k.__onFinishChange.call(k,k.getValue())}return M.updateDisplay(),M.__background.appendChild(M.__foreground),M.domElement.appendChild(M.__background),M}return qt(t,[{key:"updateDisplay",value:function(){var d=(this.getValue()-this.__min)/(this.__max-this.__min);return this.__foreground.style.width=d*100+"%",Yt(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updateDisplay",this).call(this)}}]),t}(un),ln=function(n){Wt(t,n);function t(i,d,f){$t(this,t);var g=Kt(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,i,d)),b=g;return g.__button=document.createElement("div"),g.__button.innerHTML=f===void 0?"Fire":f,S.bind(g.__button,"click",function(M){return M.preventDefault(),b.fire(),!1}),S.addClass(g.__button,"button"),g.domElement.appendChild(g.__button),g}return qt(t,[{key:"fire",value:function(){this.__onChange&&this.__onChange.call(this),this.getValue().call(this.object),this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue())}}]),t}(Zt),Se=function(n){Wt(t,n);function t(i,d){$t(this,t);var f=Kt(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,i,d));f.__color=new Pt(f.getValue()),f.__temp=new Pt(0);var g=f;f.domElement=document.createElement("div"),S.makeSelectable(f.domElement,!1),f.__selector=document.createElement("div"),f.__selector.className="selector",f.__saturation_field=document.createElement("div"),f.__saturation_field.className="saturation-field",f.__field_knob=document.createElement("div"),f.__field_knob.className="field-knob",f.__field_knob_border="2px solid ",f.__hue_knob=document.createElement("div"),f.__hue_knob.className="hue-knob",f.__hue_field=document.createElement("div"),f.__hue_field.className="hue-field",f.__input=document.createElement("input"),f.__input.type="text",f.__input_textShadow="0 1px 1px ",S.bind(f.__input,"keydown",function(L){L.keyCode===13&&P.call(this)}),S.bind(f.__input,"blur",P),S.bind(f.__selector,"mousedown",function(){S.addClass(this,"drag").bind(window,"mouseup",function(){S.removeClass(g.__selector,"drag")})}),S.bind(f.__selector,"touchstart",function(){S.addClass(this,"drag").bind(window,"touchend",function(){S.removeClass(g.__selector,"drag")})});var b=document.createElement("div");C.extend(f.__selector.style,{width:"122px",height:"102px",padding:"3px",backgroundColor:"#222",boxShadow:"0px 1px 3px rgba(0,0,0,0.3)"}),C.extend(f.__field_knob.style,{position:"absolute",width:"12px",height:"12px",border:f.__field_knob_border+(f.__color.v<.5?"#fff":"#000"),boxShadow:"0px 1px 3px rgba(0,0,0,0.5)",borderRadius:"12px",zIndex:1}),C.extend(f.__hue_knob.style,{position:"absolute",width:"15px",height:"2px",borderRight:"4px solid #fff",zIndex:1}),C.extend(f.__saturation_field.style,{width:"100px",height:"100px",border:"1px solid #555",marginRight:"3px",display:"inline-block",cursor:"pointer"}),C.extend(b.style,{width:"100%",height:"100%",background:"none"}),qe(b,"top","rgba(0,0,0,0)","#000"),C.extend(f.__hue_field.style,{width:"15px",height:"100px",border:"1px solid #555",cursor:"ns-resize",position:"absolute",top:"3px",right:"3px"}),Cn(f.__hue_field),C.extend(f.__input.style,{outline:"none",textAlign:"center",color:"#fff",border:0,fontWeight:"bold",textShadow:f.__input_textShadow+"rgba(0,0,0,0.7)"}),S.bind(f.__saturation_field,"mousedown",M),S.bind(f.__saturation_field,"touchstart",M),S.bind(f.__field_knob,"mousedown",M),S.bind(f.__field_knob,"touchstart",M),S.bind(f.__hue_field,"mousedown",k),S.bind(f.__hue_field,"touchstart",k);function M(L){U(L),S.bind(window,"mousemove",U),S.bind(window,"touchmove",U),S.bind(window,"mouseup",A),S.bind(window,"touchend",A)}function k(L){F(L),S.bind(window,"mousemove",F),S.bind(window,"touchmove",F),S.bind(window,"mouseup",T),S.bind(window,"touchend",T)}function A(){S.unbind(window,"mousemove",U),S.unbind(window,"touchmove",U),S.unbind(window,"mouseup",A),S.unbind(window,"touchend",A),B()}function T(){S.unbind(window,"mousemove",F),S.unbind(window,"touchmove",F),S.unbind(window,"mouseup",T),S.unbind(window,"touchend",T),B()}function P(){var L=De(this.value);L!==!1?(g.__color.__state=L,g.setValue(g.__color.toOriginal())):this.value=g.__color.toString()}function B(){g.__onFinishChange&&g.__onFinishChange.call(g,g.__color.toOriginal())}f.__saturation_field.appendChild(b),f.__selector.appendChild(f.__field_knob),f.__selector.appendChild(f.__saturation_field),f.__selector.appendChild(f.__hue_field),f.__hue_field.appendChild(f.__hue_knob),f.domElement.appendChild(f.__input),f.domElement.appendChild(f.__selector),f.updateDisplay();function U(L){L.type.indexOf("touch")===-1&&L.preventDefault();var G=g.__saturation_field.getBoundingClientRect(),K=L.touches&&L.touches[0]||L,tt=K.clientX,j=K.clientY,lt=(tt-G.left)/(G.right-G.left),q=1-(j-G.top)/(G.bottom-G.top);return q>1?q=1:q<0&&(q=0),lt>1?lt=1:lt<0&&(lt=0),g.__color.v=q,g.__color.s=lt,g.setValue(g.__color.toOriginal()),!1}function F(L){L.type.indexOf("touch")===-1&&L.preventDefault();var G=g.__hue_field.getBoundingClientRect(),K=L.touches&&L.touches[0]||L,tt=K.clientY,j=1-(tt-G.top)/(G.bottom-G.top);return j>1?j=1:j<0&&(j=0),g.__color.h=j*360,g.setValue(g.__color.toOriginal()),!1}return f}return qt(t,[{key:"updateDisplay",value:function(){var d=De(this.getValue());if(d!==!1){var f=!1;C.each(Pt.COMPONENTS,function(M){if(!C.isUndefined(d[M])&&!C.isUndefined(this.__color.__state[M])&&d[M]!==this.__color.__state[M])return f=!0,{}},this),f&&C.extend(this.__color.__state,d)}C.extend(this.__temp.__state,this.__color.__state),this.__temp.a=1;var g=this.__color.v<.5||this.__color.s>.5?255:0,b=255-g;C.extend(this.__field_knob.style,{marginLeft:100*this.__color.s-7+"px",marginTop:100*(1-this.__color.v)-7+"px",backgroundColor:this.__temp.toHexString(),border:this.__field_knob_border+"rgb("+g+","+g+","+g+")"}),this.__hue_knob.style.marginTop=(1-this.__color.h/360)*100+"px",this.__temp.s=1,this.__temp.v=1,qe(this.__saturation_field,"left","#fff",this.__temp.toHexString()),this.__input.value=this.__color.toString(),C.extend(this.__input.style,{backgroundColor:this.__color.toHexString(),color:"rgb("+g+","+g+","+g+")",textShadow:this.__input_textShadow+"rgba("+b+","+b+","+b+",.7)"})}}]),t}(Zt),Rn=["-moz-","-o-","-webkit-","-ms-",""];function qe(n,t,i,d){n.style.background="",C.each(Rn,function(f){n.style.cssText+="background: "+f+"linear-gradient("+t+", "+i+" 0%, "+d+" 100%); "})}function Cn(n){n.style.background="",n.style.cssText+="background: -moz-linear-gradient(top,  #ff0000 0%, #ff00ff 17%, #0000ff 34%, #00ffff 50%, #00ff00 67%, #ffff00 84%, #ff0000 100%);",n.style.cssText+="background: -webkit-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",n.style.cssText+="background: -o-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",n.style.cssText+="background: -ms-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",n.style.cssText+="background: linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);"}var Bn={load:function(t,i){var d=i||document,f=d.createElement("link");f.type="text/css",f.rel="stylesheet",f.href=t,d.getElementsByTagName("head")[0].appendChild(f)},inject:function(t,i){var d=i||document,f=document.createElement("style");f.type="text/css",f.innerHTML=t;var g=d.getElementsByTagName("head")[0];try{g.appendChild(f)}catch{}}},Ln=`<div id="dg-save" class="dg dialogue">

  Here's the new load parameter for your <code>GUI</code>'s constructor:

  <textarea id="dg-new-constructor"></textarea>

  <div id="dg-save-locally">

    <input id="dg-local-storage" type="checkbox"/> Automatically save
    values to <code>localStorage</code> on exit.

    <div id="dg-local-explain">The values saved to <code>localStorage</code> will
      override those passed to <code>dat.GUI</code>'s constructor. This makes it
      easier to work incrementally, but <code>localStorage</code> is fragile,
      and your friends may not see the same values you do.

    </div>

  </div>

</div>`,Nn=function(t,i){var d=t[i];return C.isArray(arguments[2])||C.isObject(arguments[2])?new On(t,i,arguments[2]):C.isNumber(d)?C.isNumber(arguments[2])&&C.isNumber(arguments[3])?C.isNumber(arguments[4])?new Ae(t,i,arguments[2],arguments[3],arguments[4]):new Ae(t,i,arguments[2],arguments[3]):C.isNumber(arguments[4])?new me(t,i,{min:arguments[2],max:arguments[3],step:arguments[4]}):new me(t,i,{min:arguments[2],max:arguments[3]}):C.isString(d)?new kn(t,i):C.isFunction(d)?new ln(t,i,""):C.isBoolean(d)?new an(t,i):null};function In(n){setTimeout(n,1e3/60)}var Fn=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||In,Un=function(){function n(){$t(this,n),this.backgroundElement=document.createElement("div"),C.extend(this.backgroundElement.style,{backgroundColor:"rgba(0,0,0,0.8)",top:0,left:0,display:"none",zIndex:"1000",opacity:0,WebkitTransition:"opacity 0.2s linear",transition:"opacity 0.2s linear"}),S.makeFullscreen(this.backgroundElement),this.backgroundElement.style.position="fixed",this.domElement=document.createElement("div"),C.extend(this.domElement.style,{position:"fixed",display:"none",zIndex:"1001",opacity:0,WebkitTransition:"-webkit-transform 0.2s ease-out, opacity 0.2s linear",transition:"transform 0.2s ease-out, opacity 0.2s linear"}),document.body.appendChild(this.backgroundElement),document.body.appendChild(this.domElement);var t=this;S.bind(this.backgroundElement,"click",function(){t.hide()})}return qt(n,[{key:"show",value:function(){var i=this;this.backgroundElement.style.display="block",this.domElement.style.display="block",this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)",this.layout(),C.defer(function(){i.backgroundElement.style.opacity=1,i.domElement.style.opacity=1,i.domElement.style.webkitTransform="scale(1)"})}},{key:"hide",value:function(){var i=this,d=function f(){i.domElement.style.display="none",i.backgroundElement.style.display="none",S.unbind(i.domElement,"webkitTransitionEnd",f),S.unbind(i.domElement,"transitionend",f),S.unbind(i.domElement,"oTransitionEnd",f)};S.bind(this.domElement,"webkitTransitionEnd",d),S.bind(this.domElement,"transitionend",d),S.bind(this.domElement,"oTransitionEnd",d),this.backgroundElement.style.opacity=0,this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)"}},{key:"layout",value:function(){this.domElement.style.left=window.innerWidth/2-S.getWidth(this.domElement)/2+"px",this.domElement.style.top=window.innerHeight/2-S.getHeight(this.domElement)/2+"px"}}]),n}(),Vn=Dn(`.dg ul{list-style:none;margin:0;padding:0;width:100%;clear:both}.dg.ac{position:fixed;top:0;left:0;right:0;height:0;z-index:0}.dg:not(.ac) .main{overflow:hidden}.dg.main{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear}.dg.main.taller-than-window{overflow-y:auto}.dg.main.taller-than-window .close-button{opacity:1;margin-top:-1px;border-top:1px solid #2c2c2c}.dg.main ul.closed .close-button{opacity:1 !important}.dg.main:hover .close-button,.dg.main .close-button.drag{opacity:1}.dg.main .close-button{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear;border:0;line-height:19px;height:20px;cursor:pointer;text-align:center;background-color:#000}.dg.main .close-button.close-top{position:relative}.dg.main .close-button.close-bottom{position:absolute}.dg.main .close-button:hover{background-color:#111}.dg.a{float:right;margin-right:15px;overflow-y:visible}.dg.a.has-save>ul.close-top{margin-top:0}.dg.a.has-save>ul.close-bottom{margin-top:27px}.dg.a.has-save>ul.closed{margin-top:0}.dg.a .save-row{top:0;z-index:1002}.dg.a .save-row.close-top{position:relative}.dg.a .save-row.close-bottom{position:fixed}.dg li{-webkit-transition:height .1s ease-out;-o-transition:height .1s ease-out;-moz-transition:height .1s ease-out;transition:height .1s ease-out;-webkit-transition:overflow .1s linear;-o-transition:overflow .1s linear;-moz-transition:overflow .1s linear;transition:overflow .1s linear}.dg li:not(.folder){cursor:auto;height:27px;line-height:27px;padding:0 4px 0 5px}.dg li.folder{padding:0;border-left:4px solid rgba(0,0,0,0)}.dg li.title{cursor:pointer;margin-left:-4px}.dg .closed li:not(.title),.dg .closed ul li,.dg .closed ul li>*{height:0;overflow:hidden;border:0}.dg .cr{clear:both;padding-left:3px;height:27px;overflow:hidden}.dg .property-name{cursor:default;float:left;clear:left;width:40%;overflow:hidden;text-overflow:ellipsis}.dg .cr.function .property-name{width:100%}.dg .c{float:left;width:60%;position:relative}.dg .c input[type=text]{border:0;margin-top:4px;padding:3px;width:100%;float:right}.dg .has-slider input[type=text]{width:30%;margin-left:0}.dg .slider{float:left;width:66%;margin-left:-5px;margin-right:0;height:19px;margin-top:4px}.dg .slider-fg{height:100%}.dg .c input[type=checkbox]{margin-top:7px}.dg .c select{margin-top:5px}.dg .cr.function,.dg .cr.function .property-name,.dg .cr.function *,.dg .cr.boolean,.dg .cr.boolean *{cursor:pointer}.dg .cr.color{overflow:visible}.dg .selector{display:none;position:absolute;margin-left:-9px;margin-top:23px;z-index:10}.dg .c:hover .selector,.dg .selector.drag{display:block}.dg li.save-row{padding:0}.dg li.save-row .button{display:inline-block;padding:0px 6px}.dg.dialogue{background-color:#222;width:460px;padding:15px;font-size:13px;line-height:15px}#dg-new-constructor{padding:10px;color:#222;font-family:Monaco, monospace;font-size:10px;border:0;resize:none;box-shadow:inset 1px 1px 1px #888;word-wrap:break-word;margin:12px 0;display:block;width:440px;overflow-y:scroll;height:100px;position:relative}#dg-local-explain{display:none;font-size:11px;line-height:17px;border-radius:3px;background-color:#333;padding:8px;margin-top:10px}#dg-local-explain code{font-size:10px}#dat-gui-save-locally{display:none}.dg{color:#eee;font:11px 'Lucida Grande', sans-serif;text-shadow:0 -1px 0 #111}.dg.main::-webkit-scrollbar{width:5px;background:#1a1a1a}.dg.main::-webkit-scrollbar-corner{height:0;display:none}.dg.main::-webkit-scrollbar-thumb{border-radius:5px;background:#676767}.dg li:not(.folder){background:#1a1a1a;border-bottom:1px solid #2c2c2c}.dg li.save-row{line-height:25px;background:#dad5cb;border:0}.dg li.save-row select{margin-left:5px;width:108px}.dg li.save-row .button{margin-left:5px;margin-top:1px;border-radius:2px;font-size:9px;line-height:7px;padding:4px 4px 5px 4px;background:#c5bdad;color:#fff;text-shadow:0 1px 0 #b0a58f;box-shadow:0 -1px 0 #b0a58f;cursor:pointer}.dg li.save-row .button.gears{background:#c5bdad url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAANCAYAAAB/9ZQ7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQJJREFUeNpiYKAU/P//PwGIC/ApCABiBSAW+I8AClAcgKxQ4T9hoMAEUrxx2QSGN6+egDX+/vWT4e7N82AMYoPAx/evwWoYoSYbACX2s7KxCxzcsezDh3evFoDEBYTEEqycggWAzA9AuUSQQgeYPa9fPv6/YWm/Acx5IPb7ty/fw+QZblw67vDs8R0YHyQhgObx+yAJkBqmG5dPPDh1aPOGR/eugW0G4vlIoTIfyFcA+QekhhHJhPdQxbiAIguMBTQZrPD7108M6roWYDFQiIAAv6Aow/1bFwXgis+f2LUAynwoIaNcz8XNx3Dl7MEJUDGQpx9gtQ8YCueB+D26OECAAQDadt7e46D42QAAAABJRU5ErkJggg==) 2px 1px no-repeat;height:7px;width:8px}.dg li.save-row .button:hover{background-color:#bab19e;box-shadow:0 -1px 0 #b0a58f}.dg li.folder{border-bottom:0}.dg li.title{padding-left:16px;background:#000 url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlI+hKgFxoCgAOw==) 6px 10px no-repeat;cursor:pointer;border-bottom:1px solid rgba(255,255,255,0.2)}.dg .closed li.title{background-image:url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlGIWqMCbWAEAOw==)}.dg .cr.boolean{border-left:3px solid #806787}.dg .cr.color{border-left:3px solid}.dg .cr.function{border-left:3px solid #e61d5f}.dg .cr.number{border-left:3px solid #2FA1D6}.dg .cr.number input[type=text]{color:#2FA1D6}.dg .cr.string{border-left:3px solid #1ed36f}.dg .cr.string input[type=text]{color:#1ed36f}.dg .cr.function:hover,.dg .cr.boolean:hover{background:#111}.dg .c input[type=text]{background:#303030;outline:none}.dg .c input[type=text]:hover{background:#3c3c3c}.dg .c input[type=text]:focus{background:#494949;color:#fff}.dg .c .slider{background:#303030;cursor:ew-resize}.dg .c .slider-fg{background:#2FA1D6;max-width:100%}.dg .c .slider:hover{background:#3c3c3c}.dg .c .slider:hover .slider-fg{background:#44abda}
`);Bn.inject(Vn);var Xe="dg",je=72,Ye=20,re="Default",se=function(){try{return!!window.localStorage}catch{return!1}}(),ie=void 0,We=!0,Qt=void 0,ye=!1,dn=[],wt=function n(t){var i=this,d=t||{};this.domElement=document.createElement("div"),this.__ul=document.createElement("ul"),this.domElement.appendChild(this.__ul),S.addClass(this.domElement,Xe),this.__folders={},this.__controllers=[],this.__rememberedObjects=[],this.__rememberedObjectIndecesToControllers=[],this.__listening=[],d=C.defaults(d,{closeOnTop:!1,autoPlace:!0,width:n.DEFAULT_WIDTH}),d=C.defaults(d,{resizable:d.autoPlace,hideable:d.autoPlace}),C.isUndefined(d.load)?d.load={preset:re}:d.preset&&(d.load.preset=d.preset),C.isUndefined(d.parent)&&d.hideable&&dn.push(this),d.resizable=C.isUndefined(d.parent)&&d.resizable,d.autoPlace&&C.isUndefined(d.scrollable)&&(d.scrollable=!0);var f=se&&localStorage.getItem(Jt(this,"isLocal"))==="true",g=void 0,b=void 0;if(Object.defineProperties(this,{parent:{get:function(){return d.parent}},scrollable:{get:function(){return d.scrollable}},autoPlace:{get:function(){return d.autoPlace}},closeOnTop:{get:function(){return d.closeOnTop}},preset:{get:function(){return i.parent?i.getRoot().preset:d.load.preset},set:function(B){i.parent?i.getRoot().preset=B:d.load.preset=B,qn(this),i.revert()}},width:{get:function(){return d.width},set:function(B){d.width=B,Oe(i,B)}},name:{get:function(){return d.name},set:function(B){d.name=B,b&&(b.innerHTML=d.name)}},closed:{get:function(){return d.closed},set:function(B){d.closed=B,d.closed?S.addClass(i.__ul,n.CLASS_CLOSED):S.removeClass(i.__ul,n.CLASS_CLOSED),this.onResize(),i.__closeButton&&(i.__closeButton.innerHTML=B?n.TEXT_OPEN:n.TEXT_CLOSED)}},load:{get:function(){return d.load}},useLocalStorage:{get:function(){return f},set:function(B){se&&(f=B,B?S.bind(window,"unload",g):S.unbind(window,"unload",g),localStorage.setItem(Jt(i,"isLocal"),B))}}}),C.isUndefined(d.parent)){if(this.closed=d.closed||!1,S.addClass(this.domElement,n.CLASS_MAIN),S.makeSelectable(this.domElement,!1),se&&f){i.useLocalStorage=!0;var M=localStorage.getItem(Jt(this,"gui"));M&&(d.load=JSON.parse(M))}this.__closeButton=document.createElement("div"),this.__closeButton.innerHTML=n.TEXT_CLOSED,S.addClass(this.__closeButton,n.CLASS_CLOSE_BUTTON),d.closeOnTop?(S.addClass(this.__closeButton,n.CLASS_CLOSE_TOP),this.domElement.insertBefore(this.__closeButton,this.domElement.childNodes[0])):(S.addClass(this.__closeButton,n.CLASS_CLOSE_BOTTOM),this.domElement.appendChild(this.__closeButton)),S.bind(this.__closeButton,"click",function(){i.closed=!i.closed})}else{d.closed===void 0&&(d.closed=!0);var k=document.createTextNode(d.name);S.addClass(k,"controller-name"),b=Re(i,k);var A=function(B){return B.preventDefault(),i.closed=!i.closed,!1};S.addClass(this.__ul,n.CLASS_CLOSED),S.addClass(b,"title"),S.bind(b,"click",A),d.closed||(this.closed=!1)}d.autoPlace&&(C.isUndefined(d.parent)&&(We&&(Qt=document.createElement("div"),S.addClass(Qt,Xe),S.addClass(Qt,n.CLASS_AUTO_PLACE_CONTAINER),document.body.appendChild(Qt),We=!1),Qt.appendChild(this.domElement),S.addClass(this.domElement,n.CLASS_AUTO_PLACE)),this.parent||Oe(i,d.width)),this.__resizeHandler=function(){i.onResizeDebounced()},S.bind(window,"resize",this.__resizeHandler),S.bind(this.__ul,"webkitTransitionEnd",this.__resizeHandler),S.bind(this.__ul,"transitionend",this.__resizeHandler),S.bind(this.__ul,"oTransitionEnd",this.__resizeHandler),this.onResize(),d.resizable&&$n(this),g=function(){se&&localStorage.getItem(Jt(i,"isLocal"))==="true"&&localStorage.setItem(Jt(i,"gui"),JSON.stringify(i.getSaveObject()))},this.saveToLocalStorageIfPossible=g;function T(){var P=i.getRoot();P.width+=1,C.defer(function(){P.width-=1})}d.parent||T()};wt.toggleHide=function(){ye=!ye,C.each(dn,function(n){n.domElement.style.display=ye?"none":""})};wt.CLASS_AUTO_PLACE="a";wt.CLASS_AUTO_PLACE_CONTAINER="ac";wt.CLASS_MAIN="main";wt.CLASS_CONTROLLER_ROW="cr";wt.CLASS_TOO_TALL="taller-than-window";wt.CLASS_CLOSED="closed";wt.CLASS_CLOSE_BUTTON="close-button";wt.CLASS_CLOSE_TOP="close-top";wt.CLASS_CLOSE_BOTTOM="close-bottom";wt.CLASS_DRAG="drag";wt.DEFAULT_WIDTH=245;wt.TEXT_CLOSED="Close Controls";wt.TEXT_OPEN="Open Controls";wt._keydownHandler=function(n){document.activeElement.type!=="text"&&(n.which===je||n.keyCode===je)&&wt.toggleHide()};S.bind(window,"keydown",wt._keydownHandler,!1);C.extend(wt.prototype,{add:function(t,i){return oe(this,t,i,{factoryArgs:Array.prototype.slice.call(arguments,2)})},addColor:function(t,i){return oe(this,t,i,{color:!0})},remove:function(t){this.__ul.removeChild(t.__li),this.__controllers.splice(this.__controllers.indexOf(t),1);var i=this;C.defer(function(){i.onResize()})},destroy:function(){if(this.parent)throw new Error("Only the root GUI should be removed with .destroy(). For subfolders, use gui.removeFolder(folder) instead.");this.autoPlace&&Qt.removeChild(this.domElement);var t=this;C.each(this.__folders,function(i){t.removeFolder(i)}),S.unbind(window,"keydown",wt._keydownHandler,!1),Ke(this)},addFolder:function(t){if(this.__folders[t]!==void 0)throw new Error('You already have a folder in this GUI by the name "'+t+'"');var i={name:t,parent:this};i.autoPlace=this.autoPlace,this.load&&this.load.folders&&this.load.folders[t]&&(i.closed=this.load.folders[t].closed,i.load=this.load.folders[t]);var d=new wt(i);this.__folders[t]=d;var f=Re(this,d.domElement);return S.addClass(f,"folder"),d},removeFolder:function(t){this.__ul.removeChild(t.domElement.parentElement),delete this.__folders[t.name],this.load&&this.load.folders&&this.load.folders[t.name]&&delete this.load.folders[t.name],Ke(t);var i=this;C.each(t.__folders,function(d){t.removeFolder(d)}),C.defer(function(){i.onResize()})},open:function(){this.closed=!1},close:function(){this.closed=!0},hide:function(){this.domElement.style.display="none"},show:function(){this.domElement.style.display=""},onResize:function(){var t=this.getRoot();if(t.scrollable){var i=S.getOffset(t.__ul).top,d=0;C.each(t.__ul.childNodes,function(f){t.autoPlace&&f===t.__save_row||(d+=S.getHeight(f))}),window.innerHeight-i-Ye<d?(S.addClass(t.domElement,wt.CLASS_TOO_TALL),t.__ul.style.height=window.innerHeight-i-Ye+"px"):(S.removeClass(t.domElement,wt.CLASS_TOO_TALL),t.__ul.style.height="auto")}t.__resize_handle&&C.defer(function(){t.__resize_handle.style.height=t.__ul.offsetHeight+"px"}),t.__closeButton&&(t.__closeButton.style.width=t.width+"px")},onResizeDebounced:C.debounce(function(){this.onResize()},50),remember:function(){if(C.isUndefined(ie)&&(ie=new Un,ie.domElement.innerHTML=Ln),this.parent)throw new Error("You can only call remember on a top level GUI.");var t=this;C.each(Array.prototype.slice.call(arguments),function(i){t.__rememberedObjects.length===0&&Hn(t),t.__rememberedObjects.indexOf(i)===-1&&t.__rememberedObjects.push(i)}),this.autoPlace&&Oe(this,this.width)},getRoot:function(){for(var t=this;t.parent;)t=t.parent;return t},getSaveObject:function(){var t=this.load;return t.closed=this.closed,this.__rememberedObjects.length>0&&(t.preset=this.preset,t.remembered||(t.remembered={}),t.remembered[this.preset]=_e(this)),t.folders={},C.each(this.__folders,function(i,d){t.folders[d]=i.getSaveObject()}),t},save:function(){this.load.remembered||(this.load.remembered={}),this.load.remembered[this.preset]=_e(this),Pe(this,!1),this.saveToLocalStorageIfPossible()},saveAs:function(t){this.load.remembered||(this.load.remembered={},this.load.remembered[re]=_e(this,!0)),this.load.remembered[t]=_e(this),this.preset=t,Te(this,t,!0),this.saveToLocalStorageIfPossible()},revert:function(t){C.each(this.__controllers,function(i){this.getRoot().load.remembered?fn(t||this.getRoot(),i):i.setValue(i.initialValue),i.__onFinishChange&&i.__onFinishChange.call(i,i.getValue())},this),C.each(this.__folders,function(i){i.revert(i)}),t||Pe(this.getRoot(),!1)},listen:function(t){var i=this.__listening.length===0;this.__listening.push(t),i&&hn(this.__listening)},updateDisplay:function(){C.each(this.__controllers,function(t){t.updateDisplay()}),C.each(this.__folders,function(t){t.updateDisplay()})}});function Re(n,t,i){var d=document.createElement("li");return t&&d.appendChild(t),i?n.__ul.insertBefore(d,i):n.__ul.appendChild(d),n.onResize(),d}function Ke(n){S.unbind(window,"resize",n.__resizeHandler),n.saveToLocalStorageIfPossible&&S.unbind(window,"unload",n.saveToLocalStorageIfPossible)}function Pe(n,t){var i=n.__preset_select[n.__preset_select.selectedIndex];t?i.innerHTML=i.value+"*":i.innerHTML=i.value}function Gn(n,t,i){if(i.__li=t,i.__gui=n,C.extend(i,{options:function(b){if(arguments.length>1){var M=i.__li.nextElementSibling;return i.remove(),oe(n,i.object,i.property,{before:M,factoryArgs:[C.toArray(arguments)]})}if(C.isArray(b)||C.isObject(b)){var k=i.__li.nextElementSibling;return i.remove(),oe(n,i.object,i.property,{before:k,factoryArgs:[b]})}},name:function(b){return i.__li.firstElementChild.firstElementChild.innerHTML=b,i},listen:function(){return i.__gui.listen(i),i},remove:function(){return i.__gui.remove(i),i}}),i instanceof Ae){var d=new me(i.object,i.property,{min:i.__min,max:i.__max,step:i.__step});C.each(["updateDisplay","onChange","onFinishChange","step","min","max"],function(g){var b=i[g],M=d[g];i[g]=d[g]=function(){var k=Array.prototype.slice.call(arguments);return M.apply(d,k),b.apply(i,k)}}),S.addClass(t,"has-slider"),i.domElement.insertBefore(d.domElement,i.domElement.firstElementChild)}else if(i instanceof me){var f=function(b){if(C.isNumber(i.__min)&&C.isNumber(i.__max)){var M=i.__li.firstElementChild.firstElementChild.innerHTML,k=i.__gui.__listening.indexOf(i)>-1;i.remove();var A=oe(n,i.object,i.property,{before:i.__li.nextElementSibling,factoryArgs:[i.__min,i.__max,i.__step]});return A.name(M),k&&A.listen(),A}return b};i.min=C.compose(f,i.min),i.max=C.compose(f,i.max)}else i instanceof an?(S.bind(t,"click",function(){S.fakeEvent(i.__checkbox,"click")}),S.bind(i.__checkbox,"click",function(g){g.stopPropagation()})):i instanceof ln?(S.bind(t,"click",function(){S.fakeEvent(i.__button,"click")}),S.bind(t,"mouseover",function(){S.addClass(i.__button,"hover")}),S.bind(t,"mouseout",function(){S.removeClass(i.__button,"hover")})):i instanceof Se&&(S.addClass(t,"color"),i.updateDisplay=C.compose(function(g){return t.style.borderLeftColor=i.__color.toString(),g},i.updateDisplay),i.updateDisplay());i.setValue=C.compose(function(g){return n.getRoot().__preset_select&&i.isModified()&&Pe(n.getRoot(),!0),g},i.setValue)}function fn(n,t){var i=n.getRoot(),d=i.__rememberedObjects.indexOf(t.object);if(d!==-1){var f=i.__rememberedObjectIndecesToControllers[d];if(f===void 0&&(f={},i.__rememberedObjectIndecesToControllers[d]=f),f[t.property]=t,i.load&&i.load.remembered){var g=i.load.remembered,b=void 0;if(g[n.preset])b=g[n.preset];else if(g[re])b=g[re];else return;if(b[d]&&b[d][t.property]!==void 0){var M=b[d][t.property];t.initialValue=M,t.setValue(M)}}}}function oe(n,t,i,d){if(t[i]===void 0)throw new Error('Object "'+t+'" has no property "'+i+'"');var f=void 0;if(d.color)f=new Se(t,i);else{var g=[t,i].concat(d.factoryArgs);f=Nn.apply(n,g)}d.before instanceof Zt&&(d.before=d.before.__li),fn(n,f),S.addClass(f.domElement,"c");var b=document.createElement("span");S.addClass(b,"property-name"),b.innerHTML=f.property;var M=document.createElement("div");M.appendChild(b),M.appendChild(f.domElement);var k=Re(n,M,d.before);return S.addClass(k,wt.CLASS_CONTROLLER_ROW),f instanceof Se?S.addClass(k,"color"):S.addClass(k,Sn(f.getValue())),Gn(n,k,f),n.__controllers.push(f),f}function Jt(n,t){return document.location.href+"."+t}function Te(n,t,i){var d=document.createElement("option");d.innerHTML=t,d.value=t,n.__preset_select.appendChild(d),i&&(n.__preset_select.selectedIndex=n.__preset_select.length-1)}function Ze(n,t){t.style.display=n.useLocalStorage?"block":"none"}function Hn(n){var t=n.__save_row=document.createElement("li");S.addClass(n.domElement,"has-save"),n.__ul.insertBefore(t,n.__ul.firstChild),S.addClass(t,"save-row");var i=document.createElement("span");i.innerHTML="&nbsp;",S.addClass(i,"button gears");var d=document.createElement("span");d.innerHTML="Save",S.addClass(d,"button"),S.addClass(d,"save");var f=document.createElement("span");f.innerHTML="New",S.addClass(f,"button"),S.addClass(f,"save-as");var g=document.createElement("span");g.innerHTML="Revert",S.addClass(g,"button"),S.addClass(g,"revert");var b=n.__preset_select=document.createElement("select");if(n.load&&n.load.remembered?C.each(n.load.remembered,function(P,B){Te(n,B,B===n.preset)}):Te(n,re,!1),S.bind(b,"change",function(){for(var P=0;P<n.__preset_select.length;P++)n.__preset_select[P].innerHTML=n.__preset_select[P].value;n.preset=this.value}),t.appendChild(b),t.appendChild(i),t.appendChild(d),t.appendChild(f),t.appendChild(g),se){var M=document.getElementById("dg-local-explain"),k=document.getElementById("dg-local-storage"),A=document.getElementById("dg-save-locally");A.style.display="block",localStorage.getItem(Jt(n,"isLocal"))==="true"&&k.setAttribute("checked","checked"),Ze(n,M),S.bind(k,"change",function(){n.useLocalStorage=!n.useLocalStorage,Ze(n,M)})}var T=document.getElementById("dg-new-constructor");S.bind(T,"keydown",function(P){P.metaKey&&(P.which===67||P.keyCode===67)&&ie.hide()}),S.bind(i,"click",function(){T.innerHTML=JSON.stringify(n.getSaveObject(),void 0,2),ie.show(),T.focus(),T.select()}),S.bind(d,"click",function(){n.save()}),S.bind(f,"click",function(){var P=prompt("Enter a new preset name.");P&&n.saveAs(P)}),S.bind(g,"click",function(){n.revert()})}function $n(n){var t=void 0;n.__resize_handle=document.createElement("div"),C.extend(n.__resize_handle.style,{width:"6px",marginLeft:"-3px",height:"200px",cursor:"ew-resize",position:"absolute"});function i(g){return g.preventDefault(),n.width+=t-g.clientX,n.onResize(),t=g.clientX,!1}function d(){S.removeClass(n.__closeButton,wt.CLASS_DRAG),S.unbind(window,"mousemove",i),S.unbind(window,"mouseup",d)}function f(g){return g.preventDefault(),t=g.clientX,S.addClass(n.__closeButton,wt.CLASS_DRAG),S.bind(window,"mousemove",i),S.bind(window,"mouseup",d),!1}S.bind(n.__resize_handle,"mousedown",f),S.bind(n.__closeButton,"mousedown",f),n.domElement.insertBefore(n.__resize_handle,n.domElement.firstElementChild)}function Oe(n,t){n.domElement.style.width=t+"px",n.__save_row&&n.autoPlace&&(n.__save_row.style.width=t+"px"),n.__closeButton&&(n.__closeButton.style.width=t+"px")}function _e(n,t){var i={};return C.each(n.__rememberedObjects,function(d,f){var g={},b=n.__rememberedObjectIndecesToControllers[f];C.each(b,function(M,k){g[k]=t?M.initialValue:M.getValue()}),i[f]=g}),i}function qn(n){for(var t=0;t<n.__preset_select.length;t++)n.__preset_select[t].value===n.preset&&(n.__preset_select.selectedIndex=t)}function hn(n){n.length!==0&&Fn.call(window,function(){hn(n)}),C.each(n,function(t){t.updateDisplay()})}var Xn=wt;function jn(n,t){return class extends n{constructor(...i){super(...i),t(this)}}}const Yn=jn(Array,n=>n.fill(0));let ot=1e-6;function Wn(n){function t(v=0,y=0){const x=new n(2);return v!==void 0&&(x[0]=v,y!==void 0&&(x[1]=y)),x}const i=t;function d(v,y,x){const e=x??new n(2);return e[0]=v,e[1]=y,e}function f(v,y){const x=y??new n(2);return x[0]=Math.ceil(v[0]),x[1]=Math.ceil(v[1]),x}function g(v,y){const x=y??new n(2);return x[0]=Math.floor(v[0]),x[1]=Math.floor(v[1]),x}function b(v,y){const x=y??new n(2);return x[0]=Math.round(v[0]),x[1]=Math.round(v[1]),x}function M(v,y=0,x=1,e){const h=e??new n(2);return h[0]=Math.min(x,Math.max(y,v[0])),h[1]=Math.min(x,Math.max(y,v[1])),h}function k(v,y,x){const e=x??new n(2);return e[0]=v[0]+y[0],e[1]=v[1]+y[1],e}function A(v,y,x,e){const h=e??new n(2);return h[0]=v[0]+y[0]*x,h[1]=v[1]+y[1]*x,h}function T(v,y){const x=v[0],e=v[1],h=y[0],c=y[1],a=Math.sqrt(x*x+e*e),o=Math.sqrt(h*h+c*c),l=a*o,m=l&&it(v,y)/l;return Math.acos(m)}function P(v,y,x){const e=x??new n(2);return e[0]=v[0]-y[0],e[1]=v[1]-y[1],e}const B=P;function U(v,y){return Math.abs(v[0]-y[0])<ot&&Math.abs(v[1]-y[1])<ot}function F(v,y){return v[0]===y[0]&&v[1]===y[1]}function L(v,y,x,e){const h=e??new n(2);return h[0]=v[0]+x*(y[0]-v[0]),h[1]=v[1]+x*(y[1]-v[1]),h}function G(v,y,x,e){const h=e??new n(2);return h[0]=v[0]+x[0]*(y[0]-v[0]),h[1]=v[1]+x[1]*(y[1]-v[1]),h}function K(v,y,x){const e=x??new n(2);return e[0]=Math.max(v[0],y[0]),e[1]=Math.max(v[1],y[1]),e}function tt(v,y,x){const e=x??new n(2);return e[0]=Math.min(v[0],y[0]),e[1]=Math.min(v[1],y[1]),e}function j(v,y,x){const e=x??new n(2);return e[0]=v[0]*y,e[1]=v[1]*y,e}const lt=j;function q(v,y,x){const e=x??new n(2);return e[0]=v[0]/y,e[1]=v[1]/y,e}function nt(v,y){const x=y??new n(2);return x[0]=1/v[0],x[1]=1/v[1],x}const et=nt;function ct(v,y,x){const e=x??new n(3),h=v[0]*y[1]-v[1]*y[0];return e[0]=0,e[1]=0,e[2]=h,e}function it(v,y){return v[0]*y[0]+v[1]*y[1]}function st(v){const y=v[0],x=v[1];return Math.sqrt(y*y+x*x)}const at=st;function ut(v){const y=v[0],x=v[1];return y*y+x*x}const ht=ut;function _t(v,y){const x=v[0]-y[0],e=v[1]-y[1];return Math.sqrt(x*x+e*e)}const Z=_t;function Q(v,y){const x=v[0]-y[0],e=v[1]-y[1];return x*x+e*e}const W=Q;function vt(v,y){const x=y??new n(2),e=v[0],h=v[1],c=Math.sqrt(e*e+h*h);return c>1e-5?(x[0]=e/c,x[1]=h/c):(x[0]=0,x[1]=0),x}function bt(v,y){const x=y??new n(2);return x[0]=-v[0],x[1]=-v[1],x}function dt(v,y){const x=y??new n(2);return x[0]=v[0],x[1]=v[1],x}const Et=dt;function yt(v,y,x){const e=x??new n(2);return e[0]=v[0]*y[0],e[1]=v[1]*y[1],e}const gt=yt;function mt(v,y,x){const e=x??new n(2);return e[0]=v[0]/y[0],e[1]=v[1]/y[1],e}const Mt=mt;function xt(v=1,y){const x=y??new n(2),e=Math.random()*2*Math.PI;return x[0]=Math.cos(e)*v,x[1]=Math.sin(e)*v,x}function E(v){const y=v??new n(2);return y[0]=0,y[1]=0,y}function R(v,y,x){const e=x??new n(2),h=v[0],c=v[1];return e[0]=h*y[0]+c*y[4]+y[12],e[1]=h*y[1]+c*y[5]+y[13],e}function _(v,y,x){const e=x??new n(2),h=v[0],c=v[1];return e[0]=y[0]*h+y[4]*c+y[8],e[1]=y[1]*h+y[5]*c+y[9],e}function s(v,y,x,e){const h=e??new n(2),c=v[0]-y[0],a=v[1]-y[1],o=Math.sin(x),l=Math.cos(x);return h[0]=c*l-a*o+y[0],h[1]=c*o+a*l+y[1],h}function u(v,y,x){const e=x??new n(2);return vt(v,e),j(e,y,e)}function r(v,y,x){const e=x??new n(2);return st(v)>y?u(v,y,e):dt(v,e)}function p(v,y,x){const e=x??new n(2);return L(v,y,.5,e)}return{create:t,fromValues:i,set:d,ceil:f,floor:g,round:b,clamp:M,add:k,addScaled:A,angle:T,subtract:P,sub:B,equalsApproximately:U,equals:F,lerp:L,lerpV:G,max:K,min:tt,mulScalar:j,scale:lt,divScalar:q,inverse:nt,invert:et,cross:ct,dot:it,length:st,len:at,lengthSq:ut,lenSq:ht,distance:_t,dist:Z,distanceSq:Q,distSq:W,normalize:vt,negate:bt,copy:dt,clone:Et,multiply:yt,mul:gt,divide:mt,div:Mt,random:xt,zero:E,transformMat4:R,transformMat3:_,rotate:s,setLength:u,truncate:r,midpoint:p}}const Qe=new Map;function pn(n){let t=Qe.get(n);return t||(t=Wn(n),Qe.set(n,t)),t}function Kn(n){function t(o,l,m){const w=new n(3);return o!==void 0&&(w[0]=o,l!==void 0&&(w[1]=l,m!==void 0&&(w[2]=m))),w}const i=t;function d(o,l,m,w){const D=w??new n(3);return D[0]=o,D[1]=l,D[2]=m,D}function f(o,l){const m=l??new n(3);return m[0]=Math.ceil(o[0]),m[1]=Math.ceil(o[1]),m[2]=Math.ceil(o[2]),m}function g(o,l){const m=l??new n(3);return m[0]=Math.floor(o[0]),m[1]=Math.floor(o[1]),m[2]=Math.floor(o[2]),m}function b(o,l){const m=l??new n(3);return m[0]=Math.round(o[0]),m[1]=Math.round(o[1]),m[2]=Math.round(o[2]),m}function M(o,l=0,m=1,w){const D=w??new n(3);return D[0]=Math.min(m,Math.max(l,o[0])),D[1]=Math.min(m,Math.max(l,o[1])),D[2]=Math.min(m,Math.max(l,o[2])),D}function k(o,l,m){const w=m??new n(3);return w[0]=o[0]+l[0],w[1]=o[1]+l[1],w[2]=o[2]+l[2],w}function A(o,l,m,w){const D=w??new n(3);return D[0]=o[0]+l[0]*m,D[1]=o[1]+l[1]*m,D[2]=o[2]+l[2]*m,D}function T(o,l){const m=o[0],w=o[1],D=o[2],O=l[0],z=l[1],V=l[2],N=Math.sqrt(m*m+w*w+D*D),I=Math.sqrt(O*O+z*z+V*V),H=N*I,J=H&&it(o,l)/H;return Math.acos(J)}function P(o,l,m){const w=m??new n(3);return w[0]=o[0]-l[0],w[1]=o[1]-l[1],w[2]=o[2]-l[2],w}const B=P;function U(o,l){return Math.abs(o[0]-l[0])<ot&&Math.abs(o[1]-l[1])<ot&&Math.abs(o[2]-l[2])<ot}function F(o,l){return o[0]===l[0]&&o[1]===l[1]&&o[2]===l[2]}function L(o,l,m,w){const D=w??new n(3);return D[0]=o[0]+m*(l[0]-o[0]),D[1]=o[1]+m*(l[1]-o[1]),D[2]=o[2]+m*(l[2]-o[2]),D}function G(o,l,m,w){const D=w??new n(3);return D[0]=o[0]+m[0]*(l[0]-o[0]),D[1]=o[1]+m[1]*(l[1]-o[1]),D[2]=o[2]+m[2]*(l[2]-o[2]),D}function K(o,l,m){const w=m??new n(3);return w[0]=Math.max(o[0],l[0]),w[1]=Math.max(o[1],l[1]),w[2]=Math.max(o[2],l[2]),w}function tt(o,l,m){const w=m??new n(3);return w[0]=Math.min(o[0],l[0]),w[1]=Math.min(o[1],l[1]),w[2]=Math.min(o[2],l[2]),w}function j(o,l,m){const w=m??new n(3);return w[0]=o[0]*l,w[1]=o[1]*l,w[2]=o[2]*l,w}const lt=j;function q(o,l,m){const w=m??new n(3);return w[0]=o[0]/l,w[1]=o[1]/l,w[2]=o[2]/l,w}function nt(o,l){const m=l??new n(3);return m[0]=1/o[0],m[1]=1/o[1],m[2]=1/o[2],m}const et=nt;function ct(o,l,m){const w=m??new n(3),D=o[2]*l[0]-o[0]*l[2],O=o[0]*l[1]-o[1]*l[0];return w[0]=o[1]*l[2]-o[2]*l[1],w[1]=D,w[2]=O,w}function it(o,l){return o[0]*l[0]+o[1]*l[1]+o[2]*l[2]}function st(o){const l=o[0],m=o[1],w=o[2];return Math.sqrt(l*l+m*m+w*w)}const at=st;function ut(o){const l=o[0],m=o[1],w=o[2];return l*l+m*m+w*w}const ht=ut;function _t(o,l){const m=o[0]-l[0],w=o[1]-l[1],D=o[2]-l[2];return Math.sqrt(m*m+w*w+D*D)}const Z=_t;function Q(o,l){const m=o[0]-l[0],w=o[1]-l[1],D=o[2]-l[2];return m*m+w*w+D*D}const W=Q;function vt(o,l){const m=l??new n(3),w=o[0],D=o[1],O=o[2],z=Math.sqrt(w*w+D*D+O*O);return z>1e-5?(m[0]=w/z,m[1]=D/z,m[2]=O/z):(m[0]=0,m[1]=0,m[2]=0),m}function bt(o,l){const m=l??new n(3);return m[0]=-o[0],m[1]=-o[1],m[2]=-o[2],m}function dt(o,l){const m=l??new n(3);return m[0]=o[0],m[1]=o[1],m[2]=o[2],m}const Et=dt;function yt(o,l,m){const w=m??new n(3);return w[0]=o[0]*l[0],w[1]=o[1]*l[1],w[2]=o[2]*l[2],w}const gt=yt;function mt(o,l,m){const w=m??new n(3);return w[0]=o[0]/l[0],w[1]=o[1]/l[1],w[2]=o[2]/l[2],w}const Mt=mt;function xt(o=1,l){const m=l??new n(3),w=Math.random()*2*Math.PI,D=Math.random()*2-1,O=Math.sqrt(1-D*D)*o;return m[0]=Math.cos(w)*O,m[1]=Math.sin(w)*O,m[2]=D*o,m}function E(o){const l=o??new n(3);return l[0]=0,l[1]=0,l[2]=0,l}function R(o,l,m){const w=m??new n(3),D=o[0],O=o[1],z=o[2],V=l[3]*D+l[7]*O+l[11]*z+l[15]||1;return w[0]=(l[0]*D+l[4]*O+l[8]*z+l[12])/V,w[1]=(l[1]*D+l[5]*O+l[9]*z+l[13])/V,w[2]=(l[2]*D+l[6]*O+l[10]*z+l[14])/V,w}function _(o,l,m){const w=m??new n(3),D=o[0],O=o[1],z=o[2];return w[0]=D*l[0*4+0]+O*l[1*4+0]+z*l[2*4+0],w[1]=D*l[0*4+1]+O*l[1*4+1]+z*l[2*4+1],w[2]=D*l[0*4+2]+O*l[1*4+2]+z*l[2*4+2],w}function s(o,l,m){const w=m??new n(3),D=o[0],O=o[1],z=o[2];return w[0]=D*l[0]+O*l[4]+z*l[8],w[1]=D*l[1]+O*l[5]+z*l[9],w[2]=D*l[2]+O*l[6]+z*l[10],w}function u(o,l,m){const w=m??new n(3),D=l[0],O=l[1],z=l[2],V=l[3]*2,N=o[0],I=o[1],H=o[2],J=O*H-z*I,$=z*N-D*H,X=D*I-O*N;return w[0]=N+J*V+(O*X-z*$)*2,w[1]=I+$*V+(z*J-D*X)*2,w[2]=H+X*V+(D*$-O*J)*2,w}function r(o,l){const m=l??new n(3);return m[0]=o[12],m[1]=o[13],m[2]=o[14],m}function p(o,l,m){const w=m??new n(3),D=l*4;return w[0]=o[D+0],w[1]=o[D+1],w[2]=o[D+2],w}function v(o,l){const m=l??new n(3),w=o[0],D=o[1],O=o[2],z=o[4],V=o[5],N=o[6],I=o[8],H=o[9],J=o[10];return m[0]=Math.sqrt(w*w+D*D+O*O),m[1]=Math.sqrt(z*z+V*V+N*N),m[2]=Math.sqrt(I*I+H*H+J*J),m}function y(o,l,m,w){const D=w??new n(3),O=[],z=[];return O[0]=o[0]-l[0],O[1]=o[1]-l[1],O[2]=o[2]-l[2],z[0]=O[0],z[1]=O[1]*Math.cos(m)-O[2]*Math.sin(m),z[2]=O[1]*Math.sin(m)+O[2]*Math.cos(m),D[0]=z[0]+l[0],D[1]=z[1]+l[1],D[2]=z[2]+l[2],D}function x(o,l,m,w){const D=w??new n(3),O=[],z=[];return O[0]=o[0]-l[0],O[1]=o[1]-l[1],O[2]=o[2]-l[2],z[0]=O[2]*Math.sin(m)+O[0]*Math.cos(m),z[1]=O[1],z[2]=O[2]*Math.cos(m)-O[0]*Math.sin(m),D[0]=z[0]+l[0],D[1]=z[1]+l[1],D[2]=z[2]+l[2],D}function e(o,l,m,w){const D=w??new n(3),O=[],z=[];return O[0]=o[0]-l[0],O[1]=o[1]-l[1],O[2]=o[2]-l[2],z[0]=O[0]*Math.cos(m)-O[1]*Math.sin(m),z[1]=O[0]*Math.sin(m)+O[1]*Math.cos(m),z[2]=O[2],D[0]=z[0]+l[0],D[1]=z[1]+l[1],D[2]=z[2]+l[2],D}function h(o,l,m){const w=m??new n(3);return vt(o,w),j(w,l,w)}function c(o,l,m){const w=m??new n(3);return st(o)>l?h(o,l,w):dt(o,w)}function a(o,l,m){const w=m??new n(3);return L(o,l,.5,w)}return{create:t,fromValues:i,set:d,ceil:f,floor:g,round:b,clamp:M,add:k,addScaled:A,angle:T,subtract:P,sub:B,equalsApproximately:U,equals:F,lerp:L,lerpV:G,max:K,min:tt,mulScalar:j,scale:lt,divScalar:q,inverse:nt,invert:et,cross:ct,dot:it,length:st,len:at,lengthSq:ut,lenSq:ht,distance:_t,dist:Z,distanceSq:Q,distSq:W,normalize:vt,negate:bt,copy:dt,clone:Et,multiply:yt,mul:gt,divide:mt,div:Mt,random:xt,zero:E,transformMat4:R,transformMat4Upper3x3:_,transformMat3:s,transformQuat:u,getTranslation:r,getAxis:p,getScaling:v,rotateX:y,rotateY:x,rotateZ:e,setLength:h,truncate:c,midpoint:a}}const Je=new Map;function ve(n){let t=Je.get(n);return t||(t=Kn(n),Je.set(n,t)),t}function Zn(n){const t=pn(n),i=ve(n);function d(s,u,r,p,v,y,x,e,h){const c=new n(12);return c[3]=0,c[7]=0,c[11]=0,s!==void 0&&(c[0]=s,u!==void 0&&(c[1]=u,r!==void 0&&(c[2]=r,p!==void 0&&(c[4]=p,v!==void 0&&(c[5]=v,y!==void 0&&(c[6]=y,x!==void 0&&(c[8]=x,e!==void 0&&(c[9]=e,h!==void 0&&(c[10]=h))))))))),c}function f(s,u,r,p,v,y,x,e,h,c){const a=c??new n(12);return a[0]=s,a[1]=u,a[2]=r,a[3]=0,a[4]=p,a[5]=v,a[6]=y,a[7]=0,a[8]=x,a[9]=e,a[10]=h,a[11]=0,a}function g(s,u){const r=u??new n(12);return r[0]=s[0],r[1]=s[1],r[2]=s[2],r[3]=0,r[4]=s[4],r[5]=s[5],r[6]=s[6],r[7]=0,r[8]=s[8],r[9]=s[9],r[10]=s[10],r[11]=0,r}function b(s,u){const r=u??new n(12),p=s[0],v=s[1],y=s[2],x=s[3],e=p+p,h=v+v,c=y+y,a=p*e,o=v*e,l=v*h,m=y*e,w=y*h,D=y*c,O=x*e,z=x*h,V=x*c;return r[0]=1-l-D,r[1]=o+V,r[2]=m-z,r[3]=0,r[4]=o-V,r[5]=1-a-D,r[6]=w+O,r[7]=0,r[8]=m+z,r[9]=w-O,r[10]=1-a-l,r[11]=0,r}function M(s,u){const r=u??new n(12);return r[0]=-s[0],r[1]=-s[1],r[2]=-s[2],r[4]=-s[4],r[5]=-s[5],r[6]=-s[6],r[8]=-s[8],r[9]=-s[9],r[10]=-s[10],r}function k(s,u,r){const p=r??new n(12);return p[0]=s[0]*u,p[1]=s[1]*u,p[2]=s[2]*u,p[4]=s[4]*u,p[5]=s[5]*u,p[6]=s[6]*u,p[8]=s[8]*u,p[9]=s[9]*u,p[10]=s[10]*u,p}const A=k;function T(s,u,r){const p=r??new n(12);return p[0]=s[0]+u[0],p[1]=s[1]+u[1],p[2]=s[2]+u[2],p[4]=s[4]+u[4],p[5]=s[5]+u[5],p[6]=s[6]+u[6],p[8]=s[8]+u[8],p[9]=s[9]+u[9],p[10]=s[10]+u[10],p}function P(s,u){const r=u??new n(12);return r[0]=s[0],r[1]=s[1],r[2]=s[2],r[4]=s[4],r[5]=s[5],r[6]=s[6],r[8]=s[8],r[9]=s[9],r[10]=s[10],r}const B=P;function U(s,u){return Math.abs(s[0]-u[0])<ot&&Math.abs(s[1]-u[1])<ot&&Math.abs(s[2]-u[2])<ot&&Math.abs(s[4]-u[4])<ot&&Math.abs(s[5]-u[5])<ot&&Math.abs(s[6]-u[6])<ot&&Math.abs(s[8]-u[8])<ot&&Math.abs(s[9]-u[9])<ot&&Math.abs(s[10]-u[10])<ot}function F(s,u){return s[0]===u[0]&&s[1]===u[1]&&s[2]===u[2]&&s[4]===u[4]&&s[5]===u[5]&&s[6]===u[6]&&s[8]===u[8]&&s[9]===u[9]&&s[10]===u[10]}function L(s){const u=s??new n(12);return u[0]=1,u[1]=0,u[2]=0,u[4]=0,u[5]=1,u[6]=0,u[8]=0,u[9]=0,u[10]=1,u}function G(s,u){const r=u??new n(12);if(r===s){let l;return l=s[1],s[1]=s[4],s[4]=l,l=s[2],s[2]=s[8],s[8]=l,l=s[6],s[6]=s[9],s[9]=l,r}const p=s[0*4+0],v=s[0*4+1],y=s[0*4+2],x=s[1*4+0],e=s[1*4+1],h=s[1*4+2],c=s[2*4+0],a=s[2*4+1],o=s[2*4+2];return r[0]=p,r[1]=x,r[2]=c,r[4]=v,r[5]=e,r[6]=a,r[8]=y,r[9]=h,r[10]=o,r}function K(s,u){const r=u??new n(12),p=s[0*4+0],v=s[0*4+1],y=s[0*4+2],x=s[1*4+0],e=s[1*4+1],h=s[1*4+2],c=s[2*4+0],a=s[2*4+1],o=s[2*4+2],l=o*e-h*a,m=-o*x+h*c,w=a*x-e*c,D=1/(p*l+v*m+y*w);return r[0]=l*D,r[1]=(-o*v+y*a)*D,r[2]=(h*v-y*e)*D,r[4]=m*D,r[5]=(o*p-y*c)*D,r[6]=(-h*p+y*x)*D,r[8]=w*D,r[9]=(-a*p+v*c)*D,r[10]=(e*p-v*x)*D,r}function tt(s){const u=s[0],r=s[0*4+1],p=s[0*4+2],v=s[1*4+0],y=s[1*4+1],x=s[1*4+2],e=s[2*4+0],h=s[2*4+1],c=s[2*4+2];return u*(y*c-h*x)-v*(r*c-h*p)+e*(r*x-y*p)}const j=K;function lt(s,u,r){const p=r??new n(12),v=s[0],y=s[1],x=s[2],e=s[4],h=s[5],c=s[6],a=s[8],o=s[9],l=s[10],m=u[0],w=u[1],D=u[2],O=u[4],z=u[5],V=u[6],N=u[8],I=u[9],H=u[10];return p[0]=v*m+e*w+a*D,p[1]=y*m+h*w+o*D,p[2]=x*m+c*w+l*D,p[4]=v*O+e*z+a*V,p[5]=y*O+h*z+o*V,p[6]=x*O+c*z+l*V,p[8]=v*N+e*I+a*H,p[9]=y*N+h*I+o*H,p[10]=x*N+c*I+l*H,p}const q=lt;function nt(s,u,r){const p=r??L();return s!==p&&(p[0]=s[0],p[1]=s[1],p[2]=s[2],p[4]=s[4],p[5]=s[5],p[6]=s[6]),p[8]=u[0],p[9]=u[1],p[10]=1,p}function et(s,u){const r=u??t.create();return r[0]=s[8],r[1]=s[9],r}function ct(s,u,r){const p=r??t.create(),v=u*4;return p[0]=s[v+0],p[1]=s[v+1],p}function it(s,u,r,p){const v=p===s?s:P(s,p),y=r*4;return v[y+0]=u[0],v[y+1]=u[1],v}function st(s,u){const r=u??t.create(),p=s[0],v=s[1],y=s[4],x=s[5];return r[0]=Math.sqrt(p*p+v*v),r[1]=Math.sqrt(y*y+x*x),r}function at(s,u){const r=u??i.create(),p=s[0],v=s[1],y=s[2],x=s[4],e=s[5],h=s[6],c=s[8],a=s[9],o=s[10];return r[0]=Math.sqrt(p*p+v*v+y*y),r[1]=Math.sqrt(x*x+e*e+h*h),r[2]=Math.sqrt(c*c+a*a+o*o),r}function ut(s,u){const r=u??new n(12);return r[0]=1,r[1]=0,r[2]=0,r[4]=0,r[5]=1,r[6]=0,r[8]=s[0],r[9]=s[1],r[10]=1,r}function ht(s,u,r){const p=r??new n(12),v=u[0],y=u[1],x=s[0],e=s[1],h=s[2],c=s[1*4+0],a=s[1*4+1],o=s[1*4+2],l=s[2*4+0],m=s[2*4+1],w=s[2*4+2];return s!==p&&(p[0]=x,p[1]=e,p[2]=h,p[4]=c,p[5]=a,p[6]=o),p[8]=x*v+c*y+l,p[9]=e*v+a*y+m,p[10]=h*v+o*y+w,p}function _t(s,u){const r=u??new n(12),p=Math.cos(s),v=Math.sin(s);return r[0]=p,r[1]=v,r[2]=0,r[4]=-v,r[5]=p,r[6]=0,r[8]=0,r[9]=0,r[10]=1,r}function Z(s,u,r){const p=r??new n(12),v=s[0*4+0],y=s[0*4+1],x=s[0*4+2],e=s[1*4+0],h=s[1*4+1],c=s[1*4+2],a=Math.cos(u),o=Math.sin(u);return p[0]=a*v+o*e,p[1]=a*y+o*h,p[2]=a*x+o*c,p[4]=a*e-o*v,p[5]=a*h-o*y,p[6]=a*c-o*x,s!==p&&(p[8]=s[8],p[9]=s[9],p[10]=s[10]),p}function Q(s,u){const r=u??new n(12),p=Math.cos(s),v=Math.sin(s);return r[0]=1,r[1]=0,r[2]=0,r[4]=0,r[5]=p,r[6]=v,r[8]=0,r[9]=-v,r[10]=p,r}function W(s,u,r){const p=r??new n(12),v=s[4],y=s[5],x=s[6],e=s[8],h=s[9],c=s[10],a=Math.cos(u),o=Math.sin(u);return p[4]=a*v+o*e,p[5]=a*y+o*h,p[6]=a*x+o*c,p[8]=a*e-o*v,p[9]=a*h-o*y,p[10]=a*c-o*x,s!==p&&(p[0]=s[0],p[1]=s[1],p[2]=s[2]),p}function vt(s,u){const r=u??new n(12),p=Math.cos(s),v=Math.sin(s);return r[0]=p,r[1]=0,r[2]=-v,r[4]=0,r[5]=1,r[6]=0,r[8]=v,r[9]=0,r[10]=p,r}function bt(s,u,r){const p=r??new n(12),v=s[0*4+0],y=s[0*4+1],x=s[0*4+2],e=s[2*4+0],h=s[2*4+1],c=s[2*4+2],a=Math.cos(u),o=Math.sin(u);return p[0]=a*v-o*e,p[1]=a*y-o*h,p[2]=a*x-o*c,p[8]=a*e+o*v,p[9]=a*h+o*y,p[10]=a*c+o*x,s!==p&&(p[4]=s[4],p[5]=s[5],p[6]=s[6]),p}const dt=_t,Et=Z;function yt(s,u){const r=u??new n(12);return r[0]=s[0],r[1]=0,r[2]=0,r[4]=0,r[5]=s[1],r[6]=0,r[8]=0,r[9]=0,r[10]=1,r}function gt(s,u,r){const p=r??new n(12),v=u[0],y=u[1];return p[0]=v*s[0*4+0],p[1]=v*s[0*4+1],p[2]=v*s[0*4+2],p[4]=y*s[1*4+0],p[5]=y*s[1*4+1],p[6]=y*s[1*4+2],s!==p&&(p[8]=s[8],p[9]=s[9],p[10]=s[10]),p}function mt(s,u){const r=u??new n(12);return r[0]=s[0],r[1]=0,r[2]=0,r[4]=0,r[5]=s[1],r[6]=0,r[8]=0,r[9]=0,r[10]=s[2],r}function Mt(s,u,r){const p=r??new n(12),v=u[0],y=u[1],x=u[2];return p[0]=v*s[0*4+0],p[1]=v*s[0*4+1],p[2]=v*s[0*4+2],p[4]=y*s[1*4+0],p[5]=y*s[1*4+1],p[6]=y*s[1*4+2],p[8]=x*s[2*4+0],p[9]=x*s[2*4+1],p[10]=x*s[2*4+2],p}function xt(s,u){const r=u??new n(12);return r[0]=s,r[1]=0,r[2]=0,r[4]=0,r[5]=s,r[6]=0,r[8]=0,r[9]=0,r[10]=1,r}function E(s,u,r){const p=r??new n(12);return p[0]=u*s[0*4+0],p[1]=u*s[0*4+1],p[2]=u*s[0*4+2],p[4]=u*s[1*4+0],p[5]=u*s[1*4+1],p[6]=u*s[1*4+2],s!==p&&(p[8]=s[8],p[9]=s[9],p[10]=s[10]),p}function R(s,u){const r=u??new n(12);return r[0]=s,r[1]=0,r[2]=0,r[4]=0,r[5]=s,r[6]=0,r[8]=0,r[9]=0,r[10]=s,r}function _(s,u,r){const p=r??new n(12);return p[0]=u*s[0*4+0],p[1]=u*s[0*4+1],p[2]=u*s[0*4+2],p[4]=u*s[1*4+0],p[5]=u*s[1*4+1],p[6]=u*s[1*4+2],p[8]=u*s[2*4+0],p[9]=u*s[2*4+1],p[10]=u*s[2*4+2],p}return{add:T,clone:B,copy:P,create:d,determinant:tt,equals:F,equalsApproximately:U,fromMat4:g,fromQuat:b,get3DScaling:at,getAxis:ct,getScaling:st,getTranslation:et,identity:L,inverse:K,invert:j,mul:q,mulScalar:A,multiply:lt,multiplyScalar:k,negate:M,rotate:Z,rotateX:W,rotateY:bt,rotateZ:Et,rotation:_t,rotationX:Q,rotationY:vt,rotationZ:dt,scale:gt,scale3D:Mt,scaling:yt,scaling3D:mt,set:f,setAxis:it,setTranslation:nt,translate:ht,translation:ut,transpose:G,uniformScale:E,uniformScale3D:_,uniformScaling:xt,uniformScaling3D:R}}const tn=new Map;function Qn(n){let t=tn.get(n);return t||(t=Zn(n),tn.set(n,t)),t}function Jn(n){const t=ve(n);function i(e,h,c,a,o,l,m,w,D,O,z,V,N,I,H,J){const $=new n(16);return e!==void 0&&($[0]=e,h!==void 0&&($[1]=h,c!==void 0&&($[2]=c,a!==void 0&&($[3]=a,o!==void 0&&($[4]=o,l!==void 0&&($[5]=l,m!==void 0&&($[6]=m,w!==void 0&&($[7]=w,D!==void 0&&($[8]=D,O!==void 0&&($[9]=O,z!==void 0&&($[10]=z,V!==void 0&&($[11]=V,N!==void 0&&($[12]=N,I!==void 0&&($[13]=I,H!==void 0&&($[14]=H,J!==void 0&&($[15]=J)))))))))))))))),$}function d(e,h,c,a,o,l,m,w,D,O,z,V,N,I,H,J,$){const X=$??new n(16);return X[0]=e,X[1]=h,X[2]=c,X[3]=a,X[4]=o,X[5]=l,X[6]=m,X[7]=w,X[8]=D,X[9]=O,X[10]=z,X[11]=V,X[12]=N,X[13]=I,X[14]=H,X[15]=J,X}function f(e,h){const c=h??new n(16);return c[0]=e[0],c[1]=e[1],c[2]=e[2],c[3]=0,c[4]=e[4],c[5]=e[5],c[6]=e[6],c[7]=0,c[8]=e[8],c[9]=e[9],c[10]=e[10],c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c}function g(e,h){const c=h??new n(16),a=e[0],o=e[1],l=e[2],m=e[3],w=a+a,D=o+o,O=l+l,z=a*w,V=o*w,N=o*D,I=l*w,H=l*D,J=l*O,$=m*w,X=m*D,pt=m*O;return c[0]=1-N-J,c[1]=V+pt,c[2]=I-X,c[3]=0,c[4]=V-pt,c[5]=1-z-J,c[6]=H+$,c[7]=0,c[8]=I+X,c[9]=H-$,c[10]=1-z-N,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c}function b(e,h){const c=h??new n(16);return c[0]=-e[0],c[1]=-e[1],c[2]=-e[2],c[3]=-e[3],c[4]=-e[4],c[5]=-e[5],c[6]=-e[6],c[7]=-e[7],c[8]=-e[8],c[9]=-e[9],c[10]=-e[10],c[11]=-e[11],c[12]=-e[12],c[13]=-e[13],c[14]=-e[14],c[15]=-e[15],c}function M(e,h,c){const a=c??new n(16);return a[0]=e[0]+h[0],a[1]=e[1]+h[1],a[2]=e[2]+h[2],a[3]=e[3]+h[3],a[4]=e[4]+h[4],a[5]=e[5]+h[5],a[6]=e[6]+h[6],a[7]=e[7]+h[7],a[8]=e[8]+h[8],a[9]=e[9]+h[9],a[10]=e[10]+h[10],a[11]=e[11]+h[11],a[12]=e[12]+h[12],a[13]=e[13]+h[13],a[14]=e[14]+h[14],a[15]=e[15]+h[15],a}function k(e,h,c){const a=c??new n(16);return a[0]=e[0]*h,a[1]=e[1]*h,a[2]=e[2]*h,a[3]=e[3]*h,a[4]=e[4]*h,a[5]=e[5]*h,a[6]=e[6]*h,a[7]=e[7]*h,a[8]=e[8]*h,a[9]=e[9]*h,a[10]=e[10]*h,a[11]=e[11]*h,a[12]=e[12]*h,a[13]=e[13]*h,a[14]=e[14]*h,a[15]=e[15]*h,a}const A=k;function T(e,h){const c=h??new n(16);return c[0]=e[0],c[1]=e[1],c[2]=e[2],c[3]=e[3],c[4]=e[4],c[5]=e[5],c[6]=e[6],c[7]=e[7],c[8]=e[8],c[9]=e[9],c[10]=e[10],c[11]=e[11],c[12]=e[12],c[13]=e[13],c[14]=e[14],c[15]=e[15],c}const P=T;function B(e,h){return Math.abs(e[0]-h[0])<ot&&Math.abs(e[1]-h[1])<ot&&Math.abs(e[2]-h[2])<ot&&Math.abs(e[3]-h[3])<ot&&Math.abs(e[4]-h[4])<ot&&Math.abs(e[5]-h[5])<ot&&Math.abs(e[6]-h[6])<ot&&Math.abs(e[7]-h[7])<ot&&Math.abs(e[8]-h[8])<ot&&Math.abs(e[9]-h[9])<ot&&Math.abs(e[10]-h[10])<ot&&Math.abs(e[11]-h[11])<ot&&Math.abs(e[12]-h[12])<ot&&Math.abs(e[13]-h[13])<ot&&Math.abs(e[14]-h[14])<ot&&Math.abs(e[15]-h[15])<ot}function U(e,h){return e[0]===h[0]&&e[1]===h[1]&&e[2]===h[2]&&e[3]===h[3]&&e[4]===h[4]&&e[5]===h[5]&&e[6]===h[6]&&e[7]===h[7]&&e[8]===h[8]&&e[9]===h[9]&&e[10]===h[10]&&e[11]===h[11]&&e[12]===h[12]&&e[13]===h[13]&&e[14]===h[14]&&e[15]===h[15]}function F(e){const h=e??new n(16);return h[0]=1,h[1]=0,h[2]=0,h[3]=0,h[4]=0,h[5]=1,h[6]=0,h[7]=0,h[8]=0,h[9]=0,h[10]=1,h[11]=0,h[12]=0,h[13]=0,h[14]=0,h[15]=1,h}function L(e,h){const c=h??new n(16);if(c===e){let ft;return ft=e[1],e[1]=e[4],e[4]=ft,ft=e[2],e[2]=e[8],e[8]=ft,ft=e[3],e[3]=e[12],e[12]=ft,ft=e[6],e[6]=e[9],e[9]=ft,ft=e[7],e[7]=e[13],e[13]=ft,ft=e[11],e[11]=e[14],e[14]=ft,c}const a=e[0*4+0],o=e[0*4+1],l=e[0*4+2],m=e[0*4+3],w=e[1*4+0],D=e[1*4+1],O=e[1*4+2],z=e[1*4+3],V=e[2*4+0],N=e[2*4+1],I=e[2*4+2],H=e[2*4+3],J=e[3*4+0],$=e[3*4+1],X=e[3*4+2],pt=e[3*4+3];return c[0]=a,c[1]=w,c[2]=V,c[3]=J,c[4]=o,c[5]=D,c[6]=N,c[7]=$,c[8]=l,c[9]=O,c[10]=I,c[11]=X,c[12]=m,c[13]=z,c[14]=H,c[15]=pt,c}function G(e,h){const c=h??new n(16),a=e[0*4+0],o=e[0*4+1],l=e[0*4+2],m=e[0*4+3],w=e[1*4+0],D=e[1*4+1],O=e[1*4+2],z=e[1*4+3],V=e[2*4+0],N=e[2*4+1],I=e[2*4+2],H=e[2*4+3],J=e[3*4+0],$=e[3*4+1],X=e[3*4+2],pt=e[3*4+3],ft=I*pt,Dt=X*H,At=O*pt,St=X*z,Tt=O*H,Ot=I*z,kt=l*pt,zt=X*m,Rt=l*H,Ct=I*m,Lt=l*z,Nt=O*m,It=V*$,Ft=J*N,Ut=w*$,Vt=J*D,Gt=w*N,ce=V*D,ae=a*$,ue=J*o,le=a*N,de=V*o,fe=a*D,he=w*o,Ne=ft*D+St*N+Tt*$-(Dt*D+At*N+Ot*$),Ie=Dt*o+kt*N+Ct*$-(ft*o+zt*N+Rt*$),Fe=At*o+zt*D+Lt*$-(St*o+kt*D+Nt*$),Ue=Ot*o+Rt*D+Nt*N-(Tt*o+Ct*D+Lt*N),Bt=1/(a*Ne+w*Ie+V*Fe+J*Ue);return c[0]=Bt*Ne,c[1]=Bt*Ie,c[2]=Bt*Fe,c[3]=Bt*Ue,c[4]=Bt*(Dt*w+At*V+Ot*J-(ft*w+St*V+Tt*J)),c[5]=Bt*(ft*a+zt*V+Rt*J-(Dt*a+kt*V+Ct*J)),c[6]=Bt*(St*a+kt*w+Nt*J-(At*a+zt*w+Lt*J)),c[7]=Bt*(Tt*a+Ct*w+Lt*V-(Ot*a+Rt*w+Nt*V)),c[8]=Bt*(It*z+Vt*H+Gt*pt-(Ft*z+Ut*H+ce*pt)),c[9]=Bt*(Ft*m+ae*H+de*pt-(It*m+ue*H+le*pt)),c[10]=Bt*(Ut*m+ue*z+fe*pt-(Vt*m+ae*z+he*pt)),c[11]=Bt*(ce*m+le*z+he*H-(Gt*m+de*z+fe*H)),c[12]=Bt*(Ut*I+ce*X+Ft*O-(Gt*X+It*O+Vt*I)),c[13]=Bt*(le*X+It*l+ue*I-(ae*I+de*X+Ft*l)),c[14]=Bt*(ae*O+he*X+Vt*l-(fe*X+Ut*l+ue*O)),c[15]=Bt*(fe*I+Gt*l+de*O-(le*O+he*I+ce*l)),c}function K(e){const h=e[0],c=e[0*4+1],a=e[0*4+2],o=e[0*4+3],l=e[1*4+0],m=e[1*4+1],w=e[1*4+2],D=e[1*4+3],O=e[2*4+0],z=e[2*4+1],V=e[2*4+2],N=e[2*4+3],I=e[3*4+0],H=e[3*4+1],J=e[3*4+2],$=e[3*4+3],X=V*$,pt=J*N,ft=w*$,Dt=J*D,At=w*N,St=V*D,Tt=a*$,Ot=J*o,kt=a*N,zt=V*o,Rt=a*D,Ct=w*o,Lt=X*m+Dt*z+At*H-(pt*m+ft*z+St*H),Nt=pt*c+Tt*z+zt*H-(X*c+Ot*z+kt*H),It=ft*c+Ot*m+Rt*H-(Dt*c+Tt*m+Ct*H),Ft=St*c+kt*m+Ct*z-(At*c+zt*m+Rt*z);return h*Lt+l*Nt+O*It+I*Ft}const tt=G;function j(e,h,c){const a=c??new n(16),o=e[0],l=e[1],m=e[2],w=e[3],D=e[4],O=e[5],z=e[6],V=e[7],N=e[8],I=e[9],H=e[10],J=e[11],$=e[12],X=e[13],pt=e[14],ft=e[15],Dt=h[0],At=h[1],St=h[2],Tt=h[3],Ot=h[4],kt=h[5],zt=h[6],Rt=h[7],Ct=h[8],Lt=h[9],Nt=h[10],It=h[11],Ft=h[12],Ut=h[13],Vt=h[14],Gt=h[15];return a[0]=o*Dt+D*At+N*St+$*Tt,a[1]=l*Dt+O*At+I*St+X*Tt,a[2]=m*Dt+z*At+H*St+pt*Tt,a[3]=w*Dt+V*At+J*St+ft*Tt,a[4]=o*Ot+D*kt+N*zt+$*Rt,a[5]=l*Ot+O*kt+I*zt+X*Rt,a[6]=m*Ot+z*kt+H*zt+pt*Rt,a[7]=w*Ot+V*kt+J*zt+ft*Rt,a[8]=o*Ct+D*Lt+N*Nt+$*It,a[9]=l*Ct+O*Lt+I*Nt+X*It,a[10]=m*Ct+z*Lt+H*Nt+pt*It,a[11]=w*Ct+V*Lt+J*Nt+ft*It,a[12]=o*Ft+D*Ut+N*Vt+$*Gt,a[13]=l*Ft+O*Ut+I*Vt+X*Gt,a[14]=m*Ft+z*Ut+H*Vt+pt*Gt,a[15]=w*Ft+V*Ut+J*Vt+ft*Gt,a}const lt=j;function q(e,h,c){const a=c??F();return e!==a&&(a[0]=e[0],a[1]=e[1],a[2]=e[2],a[3]=e[3],a[4]=e[4],a[5]=e[5],a[6]=e[6],a[7]=e[7],a[8]=e[8],a[9]=e[9],a[10]=e[10],a[11]=e[11]),a[12]=h[0],a[13]=h[1],a[14]=h[2],a[15]=1,a}function nt(e,h){const c=h??t.create();return c[0]=e[12],c[1]=e[13],c[2]=e[14],c}function et(e,h,c){const a=c??t.create(),o=h*4;return a[0]=e[o+0],a[1]=e[o+1],a[2]=e[o+2],a}function ct(e,h,c,a){const o=a===e?a:T(e,a),l=c*4;return o[l+0]=h[0],o[l+1]=h[1],o[l+2]=h[2],o}function it(e,h){const c=h??t.create(),a=e[0],o=e[1],l=e[2],m=e[4],w=e[5],D=e[6],O=e[8],z=e[9],V=e[10];return c[0]=Math.sqrt(a*a+o*o+l*l),c[1]=Math.sqrt(m*m+w*w+D*D),c[2]=Math.sqrt(O*O+z*z+V*V),c}function st(e,h,c,a,o){const l=o??new n(16),m=Math.tan(Math.PI*.5-.5*e);if(l[0]=m/h,l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[5]=m,l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[11]=-1,l[12]=0,l[13]=0,l[15]=0,Number.isFinite(a)){const w=1/(c-a);l[10]=a*w,l[14]=a*c*w}else l[10]=-1,l[14]=-c;return l}function at(e,h,c,a=1/0,o){const l=o??new n(16),m=1/Math.tan(e*.5);if(l[0]=m/h,l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[5]=m,l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[11]=-1,l[12]=0,l[13]=0,l[15]=0,a===1/0)l[10]=0,l[14]=c;else{const w=1/(a-c);l[10]=c*w,l[14]=a*c*w}return l}function ut(e,h,c,a,o,l,m){const w=m??new n(16);return w[0]=2/(h-e),w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=2/(a-c),w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[10]=1/(o-l),w[11]=0,w[12]=(h+e)/(e-h),w[13]=(a+c)/(c-a),w[14]=o/(o-l),w[15]=1,w}function ht(e,h,c,a,o,l,m){const w=m??new n(16),D=h-e,O=a-c,z=o-l;return w[0]=2*o/D,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=2*o/O,w[6]=0,w[7]=0,w[8]=(e+h)/D,w[9]=(a+c)/O,w[10]=l/z,w[11]=-1,w[12]=0,w[13]=0,w[14]=o*l/z,w[15]=0,w}function _t(e,h,c,a,o,l=1/0,m){const w=m??new n(16),D=h-e,O=a-c;if(w[0]=2*o/D,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=2*o/O,w[6]=0,w[7]=0,w[8]=(e+h)/D,w[9]=(a+c)/O,w[11]=-1,w[12]=0,w[13]=0,w[15]=0,l===1/0)w[10]=0,w[14]=o;else{const z=1/(l-o);w[10]=o*z,w[14]=l*o*z}return w}const Z=t.create(),Q=t.create(),W=t.create();function vt(e,h,c,a){const o=a??new n(16);return t.normalize(t.subtract(h,e,W),W),t.normalize(t.cross(c,W,Z),Z),t.normalize(t.cross(W,Z,Q),Q),o[0]=Z[0],o[1]=Z[1],o[2]=Z[2],o[3]=0,o[4]=Q[0],o[5]=Q[1],o[6]=Q[2],o[7]=0,o[8]=W[0],o[9]=W[1],o[10]=W[2],o[11]=0,o[12]=e[0],o[13]=e[1],o[14]=e[2],o[15]=1,o}function bt(e,h,c,a){const o=a??new n(16);return t.normalize(t.subtract(e,h,W),W),t.normalize(t.cross(c,W,Z),Z),t.normalize(t.cross(W,Z,Q),Q),o[0]=Z[0],o[1]=Z[1],o[2]=Z[2],o[3]=0,o[4]=Q[0],o[5]=Q[1],o[6]=Q[2],o[7]=0,o[8]=W[0],o[9]=W[1],o[10]=W[2],o[11]=0,o[12]=e[0],o[13]=e[1],o[14]=e[2],o[15]=1,o}function dt(e,h,c,a){const o=a??new n(16);return t.normalize(t.subtract(e,h,W),W),t.normalize(t.cross(c,W,Z),Z),t.normalize(t.cross(W,Z,Q),Q),o[0]=Z[0],o[1]=Q[0],o[2]=W[0],o[3]=0,o[4]=Z[1],o[5]=Q[1],o[6]=W[1],o[7]=0,o[8]=Z[2],o[9]=Q[2],o[10]=W[2],o[11]=0,o[12]=-(Z[0]*e[0]+Z[1]*e[1]+Z[2]*e[2]),o[13]=-(Q[0]*e[0]+Q[1]*e[1]+Q[2]*e[2]),o[14]=-(W[0]*e[0]+W[1]*e[1]+W[2]*e[2]),o[15]=1,o}function Et(e,h){const c=h??new n(16);return c[0]=1,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=1,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=1,c[11]=0,c[12]=e[0],c[13]=e[1],c[14]=e[2],c[15]=1,c}function yt(e,h,c){const a=c??new n(16),o=h[0],l=h[1],m=h[2],w=e[0],D=e[1],O=e[2],z=e[3],V=e[1*4+0],N=e[1*4+1],I=e[1*4+2],H=e[1*4+3],J=e[2*4+0],$=e[2*4+1],X=e[2*4+2],pt=e[2*4+3],ft=e[3*4+0],Dt=e[3*4+1],At=e[3*4+2],St=e[3*4+3];return e!==a&&(a[0]=w,a[1]=D,a[2]=O,a[3]=z,a[4]=V,a[5]=N,a[6]=I,a[7]=H,a[8]=J,a[9]=$,a[10]=X,a[11]=pt),a[12]=w*o+V*l+J*m+ft,a[13]=D*o+N*l+$*m+Dt,a[14]=O*o+I*l+X*m+At,a[15]=z*o+H*l+pt*m+St,a}function gt(e,h){const c=h??new n(16),a=Math.cos(e),o=Math.sin(e);return c[0]=1,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=a,c[6]=o,c[7]=0,c[8]=0,c[9]=-o,c[10]=a,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c}function mt(e,h,c){const a=c??new n(16),o=e[4],l=e[5],m=e[6],w=e[7],D=e[8],O=e[9],z=e[10],V=e[11],N=Math.cos(h),I=Math.sin(h);return a[4]=N*o+I*D,a[5]=N*l+I*O,a[6]=N*m+I*z,a[7]=N*w+I*V,a[8]=N*D-I*o,a[9]=N*O-I*l,a[10]=N*z-I*m,a[11]=N*V-I*w,e!==a&&(a[0]=e[0],a[1]=e[1],a[2]=e[2],a[3]=e[3],a[12]=e[12],a[13]=e[13],a[14]=e[14],a[15]=e[15]),a}function Mt(e,h){const c=h??new n(16),a=Math.cos(e),o=Math.sin(e);return c[0]=a,c[1]=0,c[2]=-o,c[3]=0,c[4]=0,c[5]=1,c[6]=0,c[7]=0,c[8]=o,c[9]=0,c[10]=a,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c}function xt(e,h,c){const a=c??new n(16),o=e[0*4+0],l=e[0*4+1],m=e[0*4+2],w=e[0*4+3],D=e[2*4+0],O=e[2*4+1],z=e[2*4+2],V=e[2*4+3],N=Math.cos(h),I=Math.sin(h);return a[0]=N*o-I*D,a[1]=N*l-I*O,a[2]=N*m-I*z,a[3]=N*w-I*V,a[8]=N*D+I*o,a[9]=N*O+I*l,a[10]=N*z+I*m,a[11]=N*V+I*w,e!==a&&(a[4]=e[4],a[5]=e[5],a[6]=e[6],a[7]=e[7],a[12]=e[12],a[13]=e[13],a[14]=e[14],a[15]=e[15]),a}function E(e,h){const c=h??new n(16),a=Math.cos(e),o=Math.sin(e);return c[0]=a,c[1]=o,c[2]=0,c[3]=0,c[4]=-o,c[5]=a,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=1,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c}function R(e,h,c){const a=c??new n(16),o=e[0*4+0],l=e[0*4+1],m=e[0*4+2],w=e[0*4+3],D=e[1*4+0],O=e[1*4+1],z=e[1*4+2],V=e[1*4+3],N=Math.cos(h),I=Math.sin(h);return a[0]=N*o+I*D,a[1]=N*l+I*O,a[2]=N*m+I*z,a[3]=N*w+I*V,a[4]=N*D-I*o,a[5]=N*O-I*l,a[6]=N*z-I*m,a[7]=N*V-I*w,e!==a&&(a[8]=e[8],a[9]=e[9],a[10]=e[10],a[11]=e[11],a[12]=e[12],a[13]=e[13],a[14]=e[14],a[15]=e[15]),a}function _(e,h,c){const a=c??new n(16);let o=e[0],l=e[1],m=e[2];const w=Math.sqrt(o*o+l*l+m*m);o/=w,l/=w,m/=w;const D=o*o,O=l*l,z=m*m,V=Math.cos(h),N=Math.sin(h),I=1-V;return a[0]=D+(1-D)*V,a[1]=o*l*I+m*N,a[2]=o*m*I-l*N,a[3]=0,a[4]=o*l*I-m*N,a[5]=O+(1-O)*V,a[6]=l*m*I+o*N,a[7]=0,a[8]=o*m*I+l*N,a[9]=l*m*I-o*N,a[10]=z+(1-z)*V,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a}const s=_;function u(e,h,c,a){const o=a??new n(16);let l=h[0],m=h[1],w=h[2];const D=Math.sqrt(l*l+m*m+w*w);l/=D,m/=D,w/=D;const O=l*l,z=m*m,V=w*w,N=Math.cos(c),I=Math.sin(c),H=1-N,J=O+(1-O)*N,$=l*m*H+w*I,X=l*w*H-m*I,pt=l*m*H-w*I,ft=z+(1-z)*N,Dt=m*w*H+l*I,At=l*w*H+m*I,St=m*w*H-l*I,Tt=V+(1-V)*N,Ot=e[0],kt=e[1],zt=e[2],Rt=e[3],Ct=e[4],Lt=e[5],Nt=e[6],It=e[7],Ft=e[8],Ut=e[9],Vt=e[10],Gt=e[11];return o[0]=J*Ot+$*Ct+X*Ft,o[1]=J*kt+$*Lt+X*Ut,o[2]=J*zt+$*Nt+X*Vt,o[3]=J*Rt+$*It+X*Gt,o[4]=pt*Ot+ft*Ct+Dt*Ft,o[5]=pt*kt+ft*Lt+Dt*Ut,o[6]=pt*zt+ft*Nt+Dt*Vt,o[7]=pt*Rt+ft*It+Dt*Gt,o[8]=At*Ot+St*Ct+Tt*Ft,o[9]=At*kt+St*Lt+Tt*Ut,o[10]=At*zt+St*Nt+Tt*Vt,o[11]=At*Rt+St*It+Tt*Gt,e!==o&&(o[12]=e[12],o[13]=e[13],o[14]=e[14],o[15]=e[15]),o}const r=u;function p(e,h){const c=h??new n(16);return c[0]=e[0],c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=e[1],c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=e[2],c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c}function v(e,h,c){const a=c??new n(16),o=h[0],l=h[1],m=h[2];return a[0]=o*e[0*4+0],a[1]=o*e[0*4+1],a[2]=o*e[0*4+2],a[3]=o*e[0*4+3],a[4]=l*e[1*4+0],a[5]=l*e[1*4+1],a[6]=l*e[1*4+2],a[7]=l*e[1*4+3],a[8]=m*e[2*4+0],a[9]=m*e[2*4+1],a[10]=m*e[2*4+2],a[11]=m*e[2*4+3],e!==a&&(a[12]=e[12],a[13]=e[13],a[14]=e[14],a[15]=e[15]),a}function y(e,h){const c=h??new n(16);return c[0]=e,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=e,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=e,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c}function x(e,h,c){const a=c??new n(16);return a[0]=h*e[0*4+0],a[1]=h*e[0*4+1],a[2]=h*e[0*4+2],a[3]=h*e[0*4+3],a[4]=h*e[1*4+0],a[5]=h*e[1*4+1],a[6]=h*e[1*4+2],a[7]=h*e[1*4+3],a[8]=h*e[2*4+0],a[9]=h*e[2*4+1],a[10]=h*e[2*4+2],a[11]=h*e[2*4+3],e!==a&&(a[12]=e[12],a[13]=e[13],a[14]=e[14],a[15]=e[15]),a}return{add:M,aim:vt,axisRotate:u,axisRotation:_,cameraAim:bt,clone:P,copy:T,create:i,determinant:K,equals:U,equalsApproximately:B,fromMat3:f,fromQuat:g,frustum:ht,frustumReverseZ:_t,getAxis:et,getScaling:it,getTranslation:nt,identity:F,inverse:G,invert:tt,lookAt:dt,mul:lt,mulScalar:A,multiply:j,multiplyScalar:k,negate:b,ortho:ut,perspective:st,perspectiveReverseZ:at,rotate:r,rotateX:mt,rotateY:xt,rotateZ:R,rotation:s,rotationX:gt,rotationY:Mt,rotationZ:E,scale:v,scaling:p,set:d,setAxis:ct,setTranslation:q,translate:yt,translation:Et,transpose:L,uniformScale:x,uniformScaling:y}}const en=new Map;function ts(n){let t=en.get(n);return t||(t=Jn(n),en.set(n,t)),t}function es(n){const t=ve(n);function i(E,R,_,s){const u=new n(4);return E!==void 0&&(u[0]=E,R!==void 0&&(u[1]=R,_!==void 0&&(u[2]=_,s!==void 0&&(u[3]=s)))),u}const d=i;function f(E,R,_,s,u){const r=u??new n(4);return r[0]=E,r[1]=R,r[2]=_,r[3]=s,r}function g(E,R,_){const s=_??new n(4),u=R*.5,r=Math.sin(u);return s[0]=r*E[0],s[1]=r*E[1],s[2]=r*E[2],s[3]=Math.cos(u),s}function b(E,R){const _=R??t.create(3),s=Math.acos(E[3])*2,u=Math.sin(s*.5);return u>ot?(_[0]=E[0]/u,_[1]=E[1]/u,_[2]=E[2]/u):(_[0]=1,_[1]=0,_[2]=0),{angle:s,axis:_}}function M(E,R){const _=st(E,R);return Math.acos(2*_*_-1)}function k(E,R,_){const s=_??new n(4),u=E[0],r=E[1],p=E[2],v=E[3],y=R[0],x=R[1],e=R[2],h=R[3];return s[0]=u*h+v*y+r*e-p*x,s[1]=r*h+v*x+p*y-u*e,s[2]=p*h+v*e+u*x-r*y,s[3]=v*h-u*y-r*x-p*e,s}const A=k;function T(E,R,_){const s=_??new n(4),u=R*.5,r=E[0],p=E[1],v=E[2],y=E[3],x=Math.sin(u),e=Math.cos(u);return s[0]=r*e+y*x,s[1]=p*e+v*x,s[2]=v*e-p*x,s[3]=y*e-r*x,s}function P(E,R,_){const s=_??new n(4),u=R*.5,r=E[0],p=E[1],v=E[2],y=E[3],x=Math.sin(u),e=Math.cos(u);return s[0]=r*e-v*x,s[1]=p*e+y*x,s[2]=v*e+r*x,s[3]=y*e-p*x,s}function B(E,R,_){const s=_??new n(4),u=R*.5,r=E[0],p=E[1],v=E[2],y=E[3],x=Math.sin(u),e=Math.cos(u);return s[0]=r*e+p*x,s[1]=p*e-r*x,s[2]=v*e+y*x,s[3]=y*e-v*x,s}function U(E,R,_,s){const u=s??new n(4),r=E[0],p=E[1],v=E[2],y=E[3];let x=R[0],e=R[1],h=R[2],c=R[3],a=r*x+p*e+v*h+y*c;a<0&&(a=-a,x=-x,e=-e,h=-h,c=-c);let o,l;if(1-a>ot){const m=Math.acos(a),w=Math.sin(m);o=Math.sin((1-_)*m)/w,l=Math.sin(_*m)/w}else o=1-_,l=_;return u[0]=o*r+l*x,u[1]=o*p+l*e,u[2]=o*v+l*h,u[3]=o*y+l*c,u}function F(E,R){const _=R??new n(4),s=E[0],u=E[1],r=E[2],p=E[3],v=s*s+u*u+r*r+p*p,y=v?1/v:0;return _[0]=-s*y,_[1]=-u*y,_[2]=-r*y,_[3]=p*y,_}function L(E,R){const _=R??new n(4);return _[0]=-E[0],_[1]=-E[1],_[2]=-E[2],_[3]=E[3],_}function G(E,R){const _=R??new n(4),s=E[0]+E[5]+E[10];if(s>0){const u=Math.sqrt(s+1);_[3]=.5*u;const r=.5/u;_[0]=(E[6]-E[9])*r,_[1]=(E[8]-E[2])*r,_[2]=(E[1]-E[4])*r}else{let u=0;E[5]>E[0]&&(u=1),E[10]>E[u*4+u]&&(u=2);const r=(u+1)%3,p=(u+2)%3,v=Math.sqrt(E[u*4+u]-E[r*4+r]-E[p*4+p]+1);_[u]=.5*v;const y=.5/v;_[3]=(E[r*4+p]-E[p*4+r])*y,_[r]=(E[r*4+u]+E[u*4+r])*y,_[p]=(E[p*4+u]+E[u*4+p])*y}return _}function K(E,R,_,s,u){const r=u??new n(4),p=E*.5,v=R*.5,y=_*.5,x=Math.sin(p),e=Math.cos(p),h=Math.sin(v),c=Math.cos(v),a=Math.sin(y),o=Math.cos(y);switch(s){case"xyz":r[0]=x*c*o+e*h*a,r[1]=e*h*o-x*c*a,r[2]=e*c*a+x*h*o,r[3]=e*c*o-x*h*a;break;case"xzy":r[0]=x*c*o-e*h*a,r[1]=e*h*o-x*c*a,r[2]=e*c*a+x*h*o,r[3]=e*c*o+x*h*a;break;case"yxz":r[0]=x*c*o+e*h*a,r[1]=e*h*o-x*c*a,r[2]=e*c*a-x*h*o,r[3]=e*c*o+x*h*a;break;case"yzx":r[0]=x*c*o+e*h*a,r[1]=e*h*o+x*c*a,r[2]=e*c*a-x*h*o,r[3]=e*c*o-x*h*a;break;case"zxy":r[0]=x*c*o-e*h*a,r[1]=e*h*o+x*c*a,r[2]=e*c*a+x*h*o,r[3]=e*c*o-x*h*a;break;case"zyx":r[0]=x*c*o-e*h*a,r[1]=e*h*o+x*c*a,r[2]=e*c*a-x*h*o,r[3]=e*c*o+x*h*a;break;default:throw new Error(`Unknown rotation order: ${s}`)}return r}function tt(E,R){const _=R??new n(4);return _[0]=E[0],_[1]=E[1],_[2]=E[2],_[3]=E[3],_}const j=tt;function lt(E,R,_){const s=_??new n(4);return s[0]=E[0]+R[0],s[1]=E[1]+R[1],s[2]=E[2]+R[2],s[3]=E[3]+R[3],s}function q(E,R,_){const s=_??new n(4);return s[0]=E[0]-R[0],s[1]=E[1]-R[1],s[2]=E[2]-R[2],s[3]=E[3]-R[3],s}const nt=q;function et(E,R,_){const s=_??new n(4);return s[0]=E[0]*R,s[1]=E[1]*R,s[2]=E[2]*R,s[3]=E[3]*R,s}const ct=et;function it(E,R,_){const s=_??new n(4);return s[0]=E[0]/R,s[1]=E[1]/R,s[2]=E[2]/R,s[3]=E[3]/R,s}function st(E,R){return E[0]*R[0]+E[1]*R[1]+E[2]*R[2]+E[3]*R[3]}function at(E,R,_,s){const u=s??new n(4);return u[0]=E[0]+_*(R[0]-E[0]),u[1]=E[1]+_*(R[1]-E[1]),u[2]=E[2]+_*(R[2]-E[2]),u[3]=E[3]+_*(R[3]-E[3]),u}function ut(E){const R=E[0],_=E[1],s=E[2],u=E[3];return Math.sqrt(R*R+_*_+s*s+u*u)}const ht=ut;function _t(E){const R=E[0],_=E[1],s=E[2],u=E[3];return R*R+_*_+s*s+u*u}const Z=_t;function Q(E,R){const _=R??new n(4),s=E[0],u=E[1],r=E[2],p=E[3],v=Math.sqrt(s*s+u*u+r*r+p*p);return v>1e-5?(_[0]=s/v,_[1]=u/v,_[2]=r/v,_[3]=p/v):(_[0]=0,_[1]=0,_[2]=0,_[3]=1),_}function W(E,R){return Math.abs(E[0]-R[0])<ot&&Math.abs(E[1]-R[1])<ot&&Math.abs(E[2]-R[2])<ot&&Math.abs(E[3]-R[3])<ot}function vt(E,R){return E[0]===R[0]&&E[1]===R[1]&&E[2]===R[2]&&E[3]===R[3]}function bt(E){const R=E??new n(4);return R[0]=0,R[1]=0,R[2]=0,R[3]=1,R}const dt=t.create(),Et=t.create(),yt=t.create();function gt(E,R,_){const s=_??new n(4),u=t.dot(E,R);return u<-.999999?(t.cross(Et,E,dt),t.len(dt)<1e-6&&t.cross(yt,E,dt),t.normalize(dt,dt),g(dt,Math.PI,s),s):u>.999999?(s[0]=0,s[1]=0,s[2]=0,s[3]=1,s):(t.cross(E,R,dt),s[0]=dt[0],s[1]=dt[1],s[2]=dt[2],s[3]=1+u,Q(s,s))}const mt=new n(4),Mt=new n(4);function xt(E,R,_,s,u,r){const p=r??new n(4);return U(E,s,u,mt),U(R,_,u,Mt),U(mt,Mt,2*u*(1-u),p),p}return{create:i,fromValues:d,set:f,fromAxisAngle:g,toAxisAngle:b,angle:M,multiply:k,mul:A,rotateX:T,rotateY:P,rotateZ:B,slerp:U,inverse:F,conjugate:L,fromMat:G,fromEuler:K,copy:tt,clone:j,add:lt,subtract:q,sub:nt,mulScalar:et,scale:ct,divScalar:it,dot:st,lerp:at,length:ut,len:ht,lengthSq:_t,lenSq:Z,normalize:Q,equalsApproximately:W,equals:vt,identity:bt,rotationTo:gt,sqlerp:xt}}const nn=new Map;function ns(n){let t=nn.get(n);return t||(t=es(n),nn.set(n,t)),t}function ss(n){function t(_,s,u,r){const p=new n(4);return _!==void 0&&(p[0]=_,s!==void 0&&(p[1]=s,u!==void 0&&(p[2]=u,r!==void 0&&(p[3]=r)))),p}const i=t;function d(_,s,u,r,p){const v=p??new n(4);return v[0]=_,v[1]=s,v[2]=u,v[3]=r,v}function f(_,s){const u=s??new n(4);return u[0]=Math.ceil(_[0]),u[1]=Math.ceil(_[1]),u[2]=Math.ceil(_[2]),u[3]=Math.ceil(_[3]),u}function g(_,s){const u=s??new n(4);return u[0]=Math.floor(_[0]),u[1]=Math.floor(_[1]),u[2]=Math.floor(_[2]),u[3]=Math.floor(_[3]),u}function b(_,s){const u=s??new n(4);return u[0]=Math.round(_[0]),u[1]=Math.round(_[1]),u[2]=Math.round(_[2]),u[3]=Math.round(_[3]),u}function M(_,s=0,u=1,r){const p=r??new n(4);return p[0]=Math.min(u,Math.max(s,_[0])),p[1]=Math.min(u,Math.max(s,_[1])),p[2]=Math.min(u,Math.max(s,_[2])),p[3]=Math.min(u,Math.max(s,_[3])),p}function k(_,s,u){const r=u??new n(4);return r[0]=_[0]+s[0],r[1]=_[1]+s[1],r[2]=_[2]+s[2],r[3]=_[3]+s[3],r}function A(_,s,u,r){const p=r??new n(4);return p[0]=_[0]+s[0]*u,p[1]=_[1]+s[1]*u,p[2]=_[2]+s[2]*u,p[3]=_[3]+s[3]*u,p}function T(_,s,u){const r=u??new n(4);return r[0]=_[0]-s[0],r[1]=_[1]-s[1],r[2]=_[2]-s[2],r[3]=_[3]-s[3],r}const P=T;function B(_,s){return Math.abs(_[0]-s[0])<ot&&Math.abs(_[1]-s[1])<ot&&Math.abs(_[2]-s[2])<ot&&Math.abs(_[3]-s[3])<ot}function U(_,s){return _[0]===s[0]&&_[1]===s[1]&&_[2]===s[2]&&_[3]===s[3]}function F(_,s,u,r){const p=r??new n(4);return p[0]=_[0]+u*(s[0]-_[0]),p[1]=_[1]+u*(s[1]-_[1]),p[2]=_[2]+u*(s[2]-_[2]),p[3]=_[3]+u*(s[3]-_[3]),p}function L(_,s,u,r){const p=r??new n(4);return p[0]=_[0]+u[0]*(s[0]-_[0]),p[1]=_[1]+u[1]*(s[1]-_[1]),p[2]=_[2]+u[2]*(s[2]-_[2]),p[3]=_[3]+u[3]*(s[3]-_[3]),p}function G(_,s,u){const r=u??new n(4);return r[0]=Math.max(_[0],s[0]),r[1]=Math.max(_[1],s[1]),r[2]=Math.max(_[2],s[2]),r[3]=Math.max(_[3],s[3]),r}function K(_,s,u){const r=u??new n(4);return r[0]=Math.min(_[0],s[0]),r[1]=Math.min(_[1],s[1]),r[2]=Math.min(_[2],s[2]),r[3]=Math.min(_[3],s[3]),r}function tt(_,s,u){const r=u??new n(4);return r[0]=_[0]*s,r[1]=_[1]*s,r[2]=_[2]*s,r[3]=_[3]*s,r}const j=tt;function lt(_,s,u){const r=u??new n(4);return r[0]=_[0]/s,r[1]=_[1]/s,r[2]=_[2]/s,r[3]=_[3]/s,r}function q(_,s){const u=s??new n(4);return u[0]=1/_[0],u[1]=1/_[1],u[2]=1/_[2],u[3]=1/_[3],u}const nt=q;function et(_,s){return _[0]*s[0]+_[1]*s[1]+_[2]*s[2]+_[3]*s[3]}function ct(_){const s=_[0],u=_[1],r=_[2],p=_[3];return Math.sqrt(s*s+u*u+r*r+p*p)}const it=ct;function st(_){const s=_[0],u=_[1],r=_[2],p=_[3];return s*s+u*u+r*r+p*p}const at=st;function ut(_,s){const u=_[0]-s[0],r=_[1]-s[1],p=_[2]-s[2],v=_[3]-s[3];return Math.sqrt(u*u+r*r+p*p+v*v)}const ht=ut;function _t(_,s){const u=_[0]-s[0],r=_[1]-s[1],p=_[2]-s[2],v=_[3]-s[3];return u*u+r*r+p*p+v*v}const Z=_t;function Q(_,s){const u=s??new n(4),r=_[0],p=_[1],v=_[2],y=_[3],x=Math.sqrt(r*r+p*p+v*v+y*y);return x>1e-5?(u[0]=r/x,u[1]=p/x,u[2]=v/x,u[3]=y/x):(u[0]=0,u[1]=0,u[2]=0,u[3]=0),u}function W(_,s){const u=s??new n(4);return u[0]=-_[0],u[1]=-_[1],u[2]=-_[2],u[3]=-_[3],u}function vt(_,s){const u=s??new n(4);return u[0]=_[0],u[1]=_[1],u[2]=_[2],u[3]=_[3],u}const bt=vt;function dt(_,s,u){const r=u??new n(4);return r[0]=_[0]*s[0],r[1]=_[1]*s[1],r[2]=_[2]*s[2],r[3]=_[3]*s[3],r}const Et=dt;function yt(_,s,u){const r=u??new n(4);return r[0]=_[0]/s[0],r[1]=_[1]/s[1],r[2]=_[2]/s[2],r[3]=_[3]/s[3],r}const gt=yt;function mt(_){const s=_??new n(4);return s[0]=0,s[1]=0,s[2]=0,s[3]=0,s}function Mt(_,s,u){const r=u??new n(4),p=_[0],v=_[1],y=_[2],x=_[3];return r[0]=s[0]*p+s[4]*v+s[8]*y+s[12]*x,r[1]=s[1]*p+s[5]*v+s[9]*y+s[13]*x,r[2]=s[2]*p+s[6]*v+s[10]*y+s[14]*x,r[3]=s[3]*p+s[7]*v+s[11]*y+s[15]*x,r}function xt(_,s,u){const r=u??new n(4);return Q(_,r),tt(r,s,r)}function E(_,s,u){const r=u??new n(4);return ct(_)>s?xt(_,s,r):vt(_,r)}function R(_,s,u){const r=u??new n(4);return F(_,s,.5,r)}return{create:t,fromValues:i,set:d,ceil:f,floor:g,round:b,clamp:M,add:k,addScaled:A,subtract:T,sub:P,equalsApproximately:B,equals:U,lerp:F,lerpV:L,max:G,min:K,mulScalar:tt,scale:j,divScalar:lt,inverse:q,invert:nt,dot:et,length:ct,len:it,lengthSq:st,lenSq:at,distance:ut,dist:ht,distanceSq:_t,distSq:Z,normalize:Q,negate:W,copy:vt,clone:bt,multiply:dt,mul:Et,divide:yt,div:gt,zero:mt,transformMat4:Mt,setLength:xt,truncate:E,midpoint:R}}const sn=new Map;function is(n){let t=sn.get(n);return t||(t=ss(n),sn.set(n,t)),t}function Ce(n,t,i,d,f,g){return{mat3:Qn(n),mat4:ts(t),quat:ns(i),vec2:pn(d),vec3:ve(f),vec4:is(g)}}const{mat4:Ht,vec3:rt}=Ce(Float32Array,Float32Array,Float32Array,Float32Array,Float32Array,Float32Array);Ce(Float64Array,Float64Array,Float64Array,Float64Array,Float64Array,Float64Array);Ce(Yn,Array,Array,Array,Array,Array);function os(n,t){const i={forward:!1,backward:!1,left:!1,right:!1,up:!1,down:!1},d={x:0,y:0,zoom:0};let f=!1;const g=(b,M)=>{switch(b.code){case"KeyW":i.forward=M,b.preventDefault(),b.stopPropagation();break;case"KeyS":i.backward=M,b.preventDefault(),b.stopPropagation();break;case"KeyA":i.left=M,b.preventDefault(),b.stopPropagation();break;case"KeyD":i.right=M,b.preventDefault(),b.stopPropagation();break;case"Space":i.up=M,b.preventDefault(),b.stopPropagation();break;case"ShiftLeft":case"ControlLeft":case"KeyC":i.down=M,b.preventDefault(),b.stopPropagation();break}};return n.addEventListener("keydown",b=>g(b,!0)),n.addEventListener("keyup",b=>g(b,!1)),t.style.touchAction="pinch-zoom",t.addEventListener("pointerdown",()=>{f=!0}),t.addEventListener("pointerup",()=>{f=!1}),t.addEventListener("pointermove",b=>{f=b.pointerType==="mouse"?(b.buttons&1)!==0:!0,f&&(d.x+=b.movementX,d.y+=b.movementY)}),t.addEventListener("wheel",b=>{f=(b.buttons&1)!==0,f&&(d.zoom+=Math.sign(b.deltaY),b.preventDefault(),b.stopPropagation())},{passive:!1}),()=>{const b={digital:i,analog:{x:d.x,y:d.y,zoom:d.zoom,touching:f}};return d.x=0,d.y=0,d.zoom=0,b}}class _n{constructor(){Y(this,"$matrix",new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]));Y(this,"$view",Ht.create());Y(this,"$right",new Float32Array(this.$matrix.buffer,4*0,4));Y(this,"$up",new Float32Array(this.$matrix.buffer,4*4,4));Y(this,"$back",new Float32Array(this.$matrix.buffer,4*8,4));Y(this,"$position",new Float32Array(this.$matrix.buffer,4*12,4))}get matrix(){return this.$matrix}set matrix(t){Ht.copy(t,this.$matrix)}get view(){return this.$view}set view(t){Ht.copy(t,this.$view)}get right(){return this.$right}set right(t){rt.copy(t,this.$right)}get up(){return this.$up}set up(t){rt.copy(t,this.$up)}get back(){return this.$back}set back(t){rt.copy(t,this.$back)}get position(){return this.$position}set position(t){rt.copy(t,this.$position)}}function rs(n,t,i){return Math.min(Math.max(n,t),i)}function cs(n,t){return n-Math.floor(Math.abs(n)/t)*t*Math.sign(n)}function as(n,t,i){return rt.transformMat4Upper3x3(n,Ht.rotation(t,i))}function us(n,t,i){return rt.addScaled(n,rt.sub(t,n),i)}class ls extends _n{constructor(i){super();Y(this,"pitch",0);Y(this,"yaw",0);Y(this,"$velocity",rt.create());Y(this,"movementSpeed",10);Y(this,"rotationSpeed",1);Y(this,"frictionCoefficient",.99);if(i&&(i.position||i.target)){const d=i.position??rt.create(0,0,-5),f=i.target??rt.create(0,0,0),g=rt.normalize(rt.sub(d,f));this.recalculateAngles(g),this.position=d}}get velocity(){return this.$velocity}set velocity(i){rt.copy(i,this.$velocity)}get matrix(){return super.matrix}set matrix(i){super.matrix=i,this.recalculateAngles(this.back)}update(i,d){const f=(P,B)=>(P?1:0)-(B?1:0);this.yaw-=d.analog.x*i*this.rotationSpeed,this.pitch-=d.analog.y*i*this.rotationSpeed,this.yaw=cs(this.yaw,Math.PI*2),this.pitch=rs(this.pitch,-Math.PI/2,Math.PI/2);const g=rt.copy(this.position);super.matrix=Ht.rotateX(Ht.rotationY(this.yaw),this.pitch);const{digital:b}=d,M=f(b.right,b.left),k=f(b.up,b.down),A=rt.create(),T=f(b.backward,b.forward);return rt.addScaled(A,this.right,M,A),rt.addScaled(A,this.up,k,A),rt.addScaled(A,this.back,T,A),rt.normalize(A,A),rt.mulScalar(A,this.movementSpeed,A),this.velocity=us(A,this.velocity,(1-this.frictionCoefficient)**i),this.position=rt.addScaled(g,this.velocity,i),this.view=Ht.invert(this.matrix),this.view}recalculateAngles(i){this.yaw=Math.atan2(i[0],i[2]),this.pitch=-Math.asin(i[1])}}class ds extends _n{constructor(i){super();Y(this,"distance",0);Y(this,"angularVelocity",0);Y(this,"$axis",rt.create());Y(this,"rotationSpeed",1);Y(this,"zoomSpeed",.1);Y(this,"frictionCoefficient",.999);i&&i.position&&(this.position=i.position,this.distance=rt.len(this.position),this.back=rt.normalize(this.position),this.recalcuateRight(),this.recalcuateUp())}get axis(){return this.$axis}set axis(i){rt.copy(i,this.$axis)}get matrix(){return super.matrix}set matrix(i){super.matrix=i,this.distance=rt.len(this.position)}update(i,d){d.analog.touching?this.angularVelocity=0:this.angularVelocity*=(1-this.frictionCoefficient)**i;const g=rt.create();rt.addScaled(g,this.right,d.analog.x,g),rt.addScaled(g,this.up,-d.analog.y,g);const b=rt.cross(g,this.back),M=rt.len(b);M>1e-7&&(this.axis=rt.scale(b,1/M),this.angularVelocity=M*this.rotationSpeed);const k=this.angularVelocity*i;return k>1e-7&&(this.back=rt.normalize(as(this.back,this.axis,k)),this.recalcuateRight(),this.recalcuateUp()),d.analog.zoom!==0&&(this.distance*=1+d.analog.zoom*this.zoomSpeed),this.position=rt.scale(this.back,this.distance),this.view=Ht.invert(this.matrix),this.view}recalcuateRight(){this.right=rt.normalize(rt.cross(this.up,this.back))}recalcuateUp(){this.up=rt.normalize(rt.cross(this.back,this.right))}}class fs{constructor(t,i){Y(this,"inputHandler");Y(this,"initialCameraPosition",rt.create(0,0,3));Y(this,"instances",{wasd:new ls({position:this.initialCameraPosition}),arcball:new ds({position:this.initialCameraPosition})});Y(this,"uniformBuffer");Y(this,"aspect");Y(this,"projectionMatrix");Y(this,"modelViewProjectionMatrix",Ht.create());Y(this,"lastFrameMS",Date.now());Y(this,"type","arcball");this.device=t,this.canvas=i,this.inputHandler=os(window,i),this.uniformBuffer=t.createBuffer({size:4*36,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST}),this.aspect=i.width/i.height,this.projectionMatrix=Ht.perspective(2*Math.PI/5,this.aspect,.01,1e4)}setRenderDistance(t=1,i=100){this.projectionMatrix=Ht.perspective(2*Math.PI/5,this.aspect,t,i)}get cameraInstance(){return this.instances[this.type]}getCameraUniformData(t){const i=this.cameraInstance.update(t,this.inputHandler());return Ht.multiply(this.projectionMatrix,i,this.modelViewProjectionMatrix),new Float32Array([...this.modelViewProjectionMatrix,...i,...this.cameraInstance.position])}setType(t){this.instances[t].matrix=this.instances[this.type].matrix,this.type=t}getUniformBuffer(){return this.uniformBuffer}frame(){const t=Date.now(),i=(t-this.lastFrameMS)/1e3;this.lastFrameMS=t;const d=this.getCameraUniformData(i);this.device.queue.writeBuffer(this.uniformBuffer,0,d.buffer,d.byteOffset,d.byteLength)}}function wn(n){return n.reduce((t,i)=>t.then(d=>i().then(Array.prototype.concat.bind(d))),Promise.resolve([]))}class Be{constructor({context:t,commandEncoder:i,canvas:d,camera:f}){Y(this,"context");Y(this,"commandEncoder");Y(this,"passEncoder");Y(this,"canvas");Y(this,"ctx");Y(this,"format");Y(this,"camera");Y(this,"kernels",[]);this.context=t,this.commandEncoder=i,this.canvas=d,this.camera=f,this.format=navigator.gpu.getPreferredCanvasFormat(),this.ctx=d.getContext("webgpu"),this.ctx.configure({device:t.device,format:this.format});const g=this.context.device.createTexture({size:[d.width,d.height],format:"depth24plus",usage:GPUTextureUsage.RENDER_ATTACHMENT});this.passEncoder=this.commandEncoder.beginRenderPass({colorAttachments:[{view:this.ctx.getCurrentTexture().createView(),loadOp:"clear",storeOp:"store",clearValue:[0,0,0,1]}],depthStencilAttachment:{view:g.createView(),depthLoadOp:"clear",depthStoreOp:"store",depthClearValue:1}})}async addKernel(t){await t.prepare(),this.kernels.push(t)}async submit(){await wn(this.kernels.map(t=>()=>t.run())),this.passEncoder.end(),this.context.device.queue.submit([this.commandEncoder.finish()]),await this.context.device.queue.onSubmittedWorkDone()}static create(t){return new Be({...t,commandEncoder:t.context.device.createCommandEncoder()})}}const hs=1/3,jt=1/6,xe=n=>Math.floor(n)|0,be=new Float64Array([1,1,0,-1,1,0,1,-1,0,-1,-1,0,1,0,1,-1,0,1,1,0,-1,-1,0,-1,0,1,1,0,-1,1,0,1,-1,0,-1,-1]);function gn(n=Math.random){const t=ps(n),i=new Float64Array(t).map(g=>be[g%12*3]),d=new Float64Array(t).map(g=>be[g%12*3+1]),f=new Float64Array(t).map(g=>be[g%12*3+2]);return function(b,M,k){let A,T,P,B;const U=(b+M+k)*hs,F=xe(b+U),L=xe(M+U),G=xe(k+U),K=(F+L+G)*jt,tt=F-K,j=L-K,lt=G-K,q=b-tt,nt=M-j,et=k-lt;let ct,it,st,at,ut,ht;q>=nt?nt>=et?(ct=1,it=0,st=0,at=1,ut=1,ht=0):q>=et?(ct=1,it=0,st=0,at=1,ut=0,ht=1):(ct=0,it=0,st=1,at=1,ut=0,ht=1):nt<et?(ct=0,it=0,st=1,at=0,ut=1,ht=1):q<et?(ct=0,it=1,st=0,at=0,ut=1,ht=1):(ct=0,it=1,st=0,at=1,ut=1,ht=0);const _t=q-ct+jt,Z=nt-it+jt,Q=et-st+jt,W=q-at+2*jt,vt=nt-ut+2*jt,bt=et-ht+2*jt,dt=q-1+3*jt,Et=nt-1+3*jt,yt=et-1+3*jt,gt=F&255,mt=L&255,Mt=G&255;let xt=.6-q*q-nt*nt-et*et;if(xt<0)A=0;else{const s=gt+t[mt+t[Mt]];xt*=xt,A=xt*xt*(i[s]*q+d[s]*nt+f[s]*et)}let E=.6-_t*_t-Z*Z-Q*Q;if(E<0)T=0;else{const s=gt+ct+t[mt+it+t[Mt+st]];E*=E,T=E*E*(i[s]*_t+d[s]*Z+f[s]*Q)}let R=.6-W*W-vt*vt-bt*bt;if(R<0)P=0;else{const s=gt+at+t[mt+ut+t[Mt+ht]];R*=R,P=R*R*(i[s]*W+d[s]*vt+f[s]*bt)}let _=.6-dt*dt-Et*Et-yt*yt;if(_<0)B=0;else{const s=gt+1+t[mt+1+t[Mt+1]];_*=_,B=_*_*(i[s]*dt+d[s]*Et+f[s]*yt)}return 32*(A+T+P+B)}}function ps(n){const i=new Uint8Array(512);for(let d=0;d<512/2;d++)i[d]=d;for(let d=0;d<512/2-1;d++){const f=d+~~(n()*(256-d)),g=i[d];i[d]=i[f],i[f]=g}for(let d=256;d<512;d++)i[d]=i[d-256];return i}function _s(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Ee={exports:{}},on;function ws(){return on||(on=1,function(n){(function(t){function i(A){function T(P,B,U){this.x=P,this.y=B,this.z=U}T.prototype.dot2=function(P,B){return this.x*P+this.y*B},T.prototype.dot3=function(P,B,U){return this.x*P+this.y*B+this.z*U},this.grad3=[new T(1,1,0),new T(-1,1,0),new T(1,-1,0),new T(-1,-1,0),new T(1,0,1),new T(-1,0,1),new T(1,0,-1),new T(-1,0,-1),new T(0,1,1),new T(0,-1,1),new T(0,1,-1),new T(0,-1,-1)],this.p=[151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180],this.perm=new Array(512),this.gradP=new Array(512),this.seed(A||0)}i.prototype.seed=function(A){A>0&&A<1&&(A*=65536),A=Math.floor(A),A<256&&(A|=A<<8);for(var T=this.p,P=0;P<256;P++){var B;P&1?B=T[P]^A&255:B=T[P]^A>>8&255;var U=this.perm,F=this.gradP;U[P]=U[P+256]=B,F[P]=F[P+256]=this.grad3[B%12]}};var d=.5*(Math.sqrt(3)-1),f=(3-Math.sqrt(3))/6,g=1/3,b=1/6;i.prototype.simplex2=function(A,T){var P,B,U,F=(A+T)*d,L=Math.floor(A+F),G=Math.floor(T+F),K=(L+G)*f,tt=A-L+K,j=T-G+K,lt,q;tt>j?(lt=1,q=0):(lt=0,q=1);var nt=tt-lt+f,et=j-q+f,ct=tt-1+2*f,it=j-1+2*f;L&=255,G&=255;var st=this.perm,at=this.gradP,ut=at[L+st[G]],ht=at[L+lt+st[G+q]],_t=at[L+1+st[G+1]],Z=.5-tt*tt-j*j;Z<0?P=0:(Z*=Z,P=Z*Z*ut.dot2(tt,j));var Q=.5-nt*nt-et*et;Q<0?B=0:(Q*=Q,B=Q*Q*ht.dot2(nt,et));var W=.5-ct*ct-it*it;return W<0?U=0:(W*=W,U=W*W*_t.dot2(ct,it)),70*(P+B+U)},i.prototype.simplex3=function(A,T,P){var B,U,F,L,G=(A+T+P)*g,K=Math.floor(A+G),tt=Math.floor(T+G),j=Math.floor(P+G),lt=(K+tt+j)*b,q=A-K+lt,nt=T-tt+lt,et=P-j+lt,ct,it,st,at,ut,ht;q>=nt?nt>=et?(ct=1,it=0,st=0,at=1,ut=1,ht=0):q>=et?(ct=1,it=0,st=0,at=1,ut=0,ht=1):(ct=0,it=0,st=1,at=1,ut=0,ht=1):nt<et?(ct=0,it=0,st=1,at=0,ut=1,ht=1):q<et?(ct=0,it=1,st=0,at=0,ut=1,ht=1):(ct=0,it=1,st=0,at=1,ut=1,ht=0);var _t=q-ct+b,Z=nt-it+b,Q=et-st+b,W=q-at+2*b,vt=nt-ut+2*b,bt=et-ht+2*b,dt=q-1+3*b,Et=nt-1+3*b,yt=et-1+3*b;K&=255,tt&=255,j&=255;var gt=this.perm,mt=this.gradP,Mt=mt[K+gt[tt+gt[j]]],xt=mt[K+ct+gt[tt+it+gt[j+st]]],E=mt[K+at+gt[tt+ut+gt[j+ht]]],R=mt[K+1+gt[tt+1+gt[j+1]]],_=.5-q*q-nt*nt-et*et;_<0?B=0:(_*=_,B=_*_*Mt.dot3(q,nt,et));var s=.5-_t*_t-Z*Z-Q*Q;s<0?U=0:(s*=s,U=s*s*xt.dot3(_t,Z,Q));var u=.5-W*W-vt*vt-bt*bt;u<0?F=0:(u*=u,F=u*u*E.dot3(W,vt,bt));var r=.5-dt*dt-Et*Et-yt*yt;return r<0?L=0:(r*=r,L=r*r*R.dot3(dt,Et,yt)),32*(B+U+F+L)};function M(A){return A*A*A*(A*(A*6-15)+10)}function k(A,T,P){return(1-P)*A+P*T}i.prototype.perlin2=function(A,T){var P=Math.floor(A),B=Math.floor(T);A=A-P,T=T-B,P=P&255,B=B&255;var U=this.perm,F=this.gradP,L=F[P+U[B]].dot2(A,T),G=F[P+U[B+1]].dot2(A,T-1),K=F[P+1+U[B]].dot2(A-1,T),tt=F[P+1+U[B+1]].dot2(A-1,T-1),j=M(A);return k(k(L,K,j),k(G,tt,j),M(T))},i.prototype.perlin3=function(A,T,P){var B=Math.floor(A),U=Math.floor(T),F=Math.floor(P);A=A-B,T=T-U,P=P-F,B=B&255,U=U&255,F=F&255;var L=this.perm,G=this.gradP,K=G[B+L[U+L[F]]].dot3(A,T,P),tt=G[B+L[U+L[F+1]]].dot3(A,T,P-1),j=G[B+L[U+1+L[F]]].dot3(A,T-1,P),lt=G[B+L[U+1+L[F+1]]].dot3(A,T-1,P-1),q=G[B+1+L[U+L[F]]].dot3(A-1,T,P),nt=G[B+1+L[U+L[F+1]]].dot3(A-1,T,P-1),et=G[B+1+L[U+1+L[F]]].dot3(A-1,T-1,P),ct=G[B+1+L[U+1+L[F+1]]].dot3(A-1,T-1,P-1),it=M(A),st=M(T),at=M(P);return k(k(k(K,q,it),k(tt,nt,it),at),k(k(j,et,it),k(lt,ct,it),at),st)},t.Noise=i})(n.exports)}(Ee)),Ee.exports}var gs=ws();const ms=_s(gs);function mn(n){const{size:t}=n,i=gn(),d=new Float32Array(t*t*t);let f=0;for(let g=0;g<t;g++)for(let b=0;b<t;b++)for(let M=0;M<t;M++){const A=i(M*.05,b*.05,g*.05);d[f++]=A}return d}function vs(n){const{size:t,octaves:i,persistence:d,scale:f}=n,g=new Float32Array(t*t*t);function b(M,k,A){const T=Math.sin(M*12.9898+k*78.233+A*45.164)*43758.5453;return T-Math.floor(T)}for(let M=0;M<t;M+=1)for(let k=0;k<t;k+=1)for(let A=0;A<t;A+=1){let T=1,P=f,B=0;for(let F=0;F<i;F+=1){const L=A*P,G=k*P,K=M*P,tt=b(L,G,K),j=Math.tanh(Math.PI*(tt*2-1));B+=j*T,T*=d,P*=2}const U=A+k*t+M*t*t;g[U]=B}return g}function Me(n,t,i){const d=n.createTexture({size:[t,t,t],format:"r32float",dimension:"3d",usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST|GPUTextureUsage.STORAGE_BINDING}),f=t*Float32Array.BYTES_PER_ELEMENT,g=t;return n.queue.writeTexture({texture:d},i(),{bytesPerRow:f,rowsPerImage:g},[t,t,t]),d}function ys(n){const{size:t,octaves:i,persistence:d,scale:f}=n,g=gn(),b=new Float32Array(t*t*t);function M(A,T,P){const B=g(A,T,P);return 1-Math.abs(B)}function k(A,T,P){const U=A+g(A,T,P)*2,F=T+g(A+5.2,T+1.3,P+8.7)*2,L=P+g(A+9.2,T+2.8,P+1.7)*2;return[U,F,L]}for(let A=0;A<t;A++)for(let T=0;T<t;T++)for(let P=0;P<t;P++){let B=1,U=f,F=0,L=1;for(let K=0;K<i;K++){const[tt,j,lt]=k(P*U,T*U,A*U);let q=M(tt,j,lt);q=q*q;const nt=g(tt,j,lt),et=(q+nt)*.5;F+=et*B*L,B*=d,U*=2,L=q}F=F*2-1;const G=P+T*t+A*t*t;b[G]=F}return b}function xs(n){const{size:t,octaves:i}=n,d=new ms(Math.random()),f=Array.from({length:30},()=>[Math.random()*t,Math.random()*t,Math.random()*t]);function g(M,k,A){let T=1/0;for(const[P,B,U]of f){const F=M-P,L=k-B,G=A-U,K=Math.sqrt(F*F+L*L+G*G);T=Math.min(T,K)}return T/t}const b=new Float32Array(t*t*t);for(let M=0;M<t;M+=1)for(let k=0;k<t;k+=1)for(let A=0;A<t;A+=1){const T=A+k*t+M*t*t,P=A/t,B=k/t,U=M/t,F=d.perlin3(P*i,B*i,U*i),L=g(A,k,M),G=Math.max(0,1-L*8);b[T]=F*G}return b}class bs{constructor({device:t,initParticleDone:i=!1,workgroupSizeX:d=256,workgroupSizeY:f=1,workgroupSizeZ:g=1,cosmicNoiseOptions:b={size:64,octaves:4,persistence:.5,scale:.05},generateCosmicNoise:M=()=>mn(b)}){Y(this,"device");Y(this,"workgroupSize",[1,1,1]);Y(this,"initParticleDone",!1);Y(this,"cosmicNoiseOptions");Y(this,"generateCosmicNoise");Y(this,"debug",!1);Y(this,"textures",{});Y(this,"buffers",{});this.device=t,this.initParticleDone=i,this.workgroupSize=[d,f,g],this.cosmicNoiseOptions=b,this.generateCosmicNoise=M}get particleCount(){return this.cosmicNoiseOptions.size**3}}class Le{constructor(t,i){Y(this,"kernels",[]);Y(this,"passEncoder");this.context=t,this.commandEncoder=i,this.passEncoder=this.commandEncoder.beginComputePass()}async addKernel(t){await t.prepare(),this.kernels.push(t)}async submit(){await wn(this.kernels.map(t=>()=>t.run({pass:this}))),this.passEncoder.end(),this.context.device.queue.submit([this.commandEncoder.finish()]),await this.context.device.queue.onSubmittedWorkDone()}static create(t){const i=t.device.createCommandEncoder();return new Le(t,i)}}const Es=`override PARTICLE_COUNT: u32;
override CUBE_SIZE: u32;

@group(0) @binding(0) var particlesTexture: texture_storage_2d<rgba32float, write>;

@compute @workgroup_size(256)
fn cs_main(@builtin(global_invocation_id) global_id: vec3<u32>) {
  let index = global_id.x;
  if (index >= PARTICLE_COUNT) { return; }

  let size = f32(CUBE_SIZE);
  let x = f32(index % CUBE_SIZE) / (size - 1.0);
  let y = f32((index / CUBE_SIZE) % CUBE_SIZE) / (size - 1.0);
  let z = f32(index / (CUBE_SIZE * CUBE_SIZE)) / (size - 1.0);

  let position = vec3<f32>(
    x * 2.0 - 1.0,
    y * 2.0 - 1.0,
    z * 2.0 - 1.0,
  );

  let velocity = vec3<f32>(0.0);

  let dimX = textureDimensions(particlesTexture).r;
  let px = i32((index * 2u) % dimX);
  let py = i32((index * 2u) / dimX);

  textureStore(particlesTexture, vec2<i32>(px, py), vec4<f32>(position, 0.0));
  textureStore(particlesTexture, vec2<i32>(px + 1, py), vec4<f32>(velocity, 0.0));
}
`;class vn{constructor(t){Y(this,"pipeline");Y(this,"bindings",[]);Y(this,"bindGroup");this.context=t}setBinding(t,i){const d=this.bindings.findIndex(f=>f.binding===t);return d!==-1?this.bindings[d]={binding:t,resource:i}:this.bindings.push({binding:t,resource:i}),this}setBindGroup(t=[]){if(!this.pipeline)throw new Error("Pipeline not initialized!");t.forEach(({binding:i,resource:d})=>{this.setBinding(i,d)}),this.bindGroup=this.context.device.createBindGroup({layout:this.pipeline.getBindGroupLayout(0),entries:this.bindings})}}class yn extends vn{constructor(){super(...arguments);Y(this,"dispatchSize",[1,1,1])}setDispatchSize(i,d=1,f=1){this.dispatchSize=[i,d,f]}initPipeline(i,d,f){return this.pipeline?this:(this.pipeline=this.context.device.createComputePipeline({layout:"auto",compute:{module:this.context.device.createShaderModule({code:i}),entryPoint:d,constants:f}}),this)}async run(i){if(!this.pipeline)throw new Error("Pipeline not initialized!");if(!this.bindGroup)throw new Error("BindGroup not initialized!");i.pass.passEncoder.setPipeline(this.pipeline),i.pass.passEncoder.setBindGroup(0,this.bindGroup),i.pass.passEncoder.dispatchWorkgroups(...this.dispatchSize)}}const xn=n=>Array.from(new Float32Array(n)),Ms=(n,t,i)=>[...Array(n.length/t).keys()].map(d=>n.slice(d*t,(d+1)*t)).slice(0,i),Ds=async(n,t,i=xn)=>{const d=/^([rgbaRGBA]{1,4})(\d+)(\w+)?$/,f=t.format.match(d),g=f[1].length,b=parseInt(f[2],10)/8,M=g*b,k=t.width*M,A=Math.ceil(k/256)*256,T=A*t.height,P=n.createBuffer({size:T,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ}),B=n.createCommandEncoder();B.copyTextureToBuffer({texture:t},{buffer:P,bytesPerRow:A,rowsPerImage:t.height},{width:t.width,height:t.height,depthOrArrayLayers:1}),n.queue.submit([B.finish()]),await n.queue.onSubmittedWorkDone(),await P.mapAsync(GPUMapMode.READ);const U=P.getMappedRange(),F=i(U);return P.unmap(),F},bn=8,rn=Math.ceil(bn/4);class As extends yn{constructor(t){super(t),this.dispatchSize[0]=Math.ceil(t.particleCount/256)}async prepare(){const t=Math.min(8192,this.context.particleCount*rn),i=Math.ceil(this.context.particleCount*rn/t);this.context.textures.particlesTextureRead=this.context.device.createTexture({size:[t,i],format:"rgba32float",dimension:"2d",usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST|GPUTextureUsage.COPY_SRC|GPUTextureUsage.STORAGE_BINDING}),this.context.textures.particlesTextureWrite=this.context.device.createTexture({size:[t,i],format:"rgba32float",dimension:"2d",usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST|GPUTextureUsage.COPY_SRC|GPUTextureUsage.STORAGE_BINDING}),this.initPipeline(Es,"cs_main",{PARTICLE_COUNT:this.context.particleCount,CUBE_SIZE:this.context.cosmicNoiseOptions.size-2}).setBinding(0,this.context.textures.particlesTextureRead.createView()).setBindGroup()}async debug(){const t=await Ds(this.context.device,this.context.textures.particlesTextureRead,xn),i=Ms(t,bn,this.context.particleCount);console.log(i)}}const Ss=`struct Particle {
  @align(16) position: vec3<f32>, // 12 bytes + 4 bytes (padding) - Particle position
  @align(16) velocity: vec3<f32>, // 12 bytes + 4 bytes (padding) - Particle velocity
}

fn getParticle(index: u32) -> Particle {
  let dimX = textureDimensions(particlesTextureRead).r;
  let x = i32((index * 2u) % dimX);
  let y = i32((index * 2u) / dimX);

  let data1 = textureLoad(particlesTextureRead, vec2<i32>(x, y));
  let data2 = textureLoad(particlesTextureRead, vec2<i32>(x + 1, y));

  return Particle(
    data1.xyz,
    data2.xyz,
  );
}

fn setParticle(index: u32, particle: Particle) {
  let dimX = textureDimensions(particlesTextureWrite).r;
  let x = i32((index * 2u) % dimX);
  let y = i32((index * 2u) / dimX);

  textureStore(particlesTextureWrite, vec2<i32>(x, y), vec4<f32>(particle.position, 0.0));
  textureStore(particlesTextureWrite, vec2<i32>(x + 1, y), vec4<f32>(particle.velocity, 0.0));
}

override PARTICLE_COUNT: u32;

@group(0) @binding(0) var particlesTextureRead: texture_storage_2d<rgba32float, read>;
@group(0) @binding(1) var particlesTextureWrite: texture_storage_2d<rgba32float, write>;
@group(0) @binding(2) var noiseTexture: texture_storage_3d<r32float, read>;

@compute @workgroup_size(256)
fn cs_main(@builtin(global_invocation_id) global_id: vec3u) {
  let index = global_id.x;
  if (index >= PARTICLE_COUNT) { return; }

  var p = getParticle(index);

  let fieldDim = vec3f(textureDimensions(noiseTexture));
  
  let texCoord = vec3u(
    u32((p.position.x + 1.0) * (fieldDim.x - 1.0) / 2.0),
    u32((p.position.y + 1.0) * (fieldDim.y - 1.0) / 2.0),
    u32((p.position.z + 1.0) * (fieldDim.z - 1.0) / 2.0)
  );
  
  let noiseValue = textureLoad(noiseTexture, texCoord).x * 2.0 - 1.0;

  let forceMagnitude = noiseValue;
  let distanceFactor = 1.0 - length(p.velocity) * 0.1;
  let force = vec3f(forceMagnitude) * distanceFactor;
  
  p.velocity += force * 0.01;

  let damping = 1.0 - abs(noiseValue) * 2.0;
  p.velocity *= damping * 0.9;

  p.position = clamp(p.position + p.velocity, vec3f(-1.0), vec3f(1.0));

  setParticle(index, p);
}
`;class Ps extends yn{constructor(t){super(t),this.dispatchSize[0]=Math.ceil(t.particleCount/256)}async prepare(){this.initPipeline(Ss,"cs_main",{PARTICLE_COUNT:this.context.particleCount}).setBinding(0,this.context.textures.particlesTextureRead.createView()).setBinding(1,this.context.textures.particlesTextureWrite.createView()).setBinding(2,this.context.textures.cosmicNoise.createView()).setBindGroup()}}const Ts=`struct Particle {
  @align(16) position: vec3<f32>, // 12 bytes + 4 bytes (padding) - Particle position
  @align(16) velocity: vec3<f32>, // 12 bytes + 4 bytes (padding) - Particle velocity
}

struct VertexOutput {
  @builtin(position) position: vec4<f32>,
  @location(0) color: vec4<f32>,
}

struct CameraUniform {
  projectionMatrix : mat4x4<f32>,
  viewMatrix: mat4x4<f32>,
  cameraPosition: vec3<f32>,
  padding: f32,
}

override PARTICLE_COUNT: u32;

@group(0) @binding(0) var particlesTextureRead: texture_storage_2d<rgba32float, read>;
@group(0) @binding(1) var<uniform> camera: CameraUniform;

fn getParticle(index: u32) -> Particle {
  let dimX = textureDimensions(particlesTextureRead).r;
  let x = i32((index * 2u) % dimX);
  let y = i32((index * 2u) / dimX);

  let data1 = textureLoad(particlesTextureRead, vec2<i32>(x, y));
  let data2 = textureLoad(particlesTextureRead, vec2<i32>(x + 1, y));

  return Particle(
    data1.xyz,
    data2.xyz,
  );
}

@vertex
fn vs_main(@builtin(vertex_index) index: u32) -> VertexOutput {
  if (index >= PARTICLE_COUNT) {
    return VertexOutput(vec4<f32>(0.0), vec4<f32>(0.0));
  }

  var out: VertexOutput;
  let particle = getParticle(index);

  out.position = camera.projectionMatrix * vec4<f32>(particle.position.xyz, 1.0);
  out.color = vec4<f32>(1.0);

  return out;
}

@fragment
fn fs_main(input: VertexOutput) -> @location(0) vec4<f32> {
  return input.color;
}
`;class Os extends vn{constructor({renderPass:i,pipelineDescriptor:d}){super(i.context);Y(this,"renderPass");this.pipeline=this.context.device.createRenderPipeline(d),this.renderPass=i}async run(){if(!this.pipeline)throw new Error("Pipeline not initialized!");if(!this.bindGroup)throw new Error("BindGroup not initialized!");this.renderPass.passEncoder.setPipeline(this.pipeline),this.renderPass.passEncoder.setBindGroup(0,this.bindGroup)}}class ks extends Os{constructor(t){const i=t.context.device.createShaderModule({code:Ts});super({renderPass:t,pipelineDescriptor:{layout:"auto",vertex:{module:i,entryPoint:"vs_main",constants:{PARTICLE_COUNT:t.context.particleCount}},fragment:{module:i,entryPoint:"fs_main",targets:[{format:t.format}]},primitive:{topology:"point-list"},depthStencil:{format:"depth24plus",depthWriteEnabled:!0,depthCompare:"less"}}})}async prepare(){this.setBinding(0,this.renderPass.context.textures.particlesTextureRead.createView()).setBinding(1,{buffer:this.renderPass.camera.getUniformBuffer()}).setBindGroup()}async run(){super.run(),this.renderPass.passEncoder.draw(this.context.particleCount)}}const we={hash3D:vs,simplex3D:mn,structure:ys,filament:xs};async function zs(){const n=document.getElementById("warning");if(!navigator.gpu){console.error("Your browser doesn' support WebGPU!"),n==null||n.classList.remove("hide");return}const t=await navigator.gpu.requestAdapter();if(!t){console.error("WebGPU Adapter is unavailable!"),n==null||n.classList.remove("hide");return}const i=await t.requestDevice({requiredLimits:{maxTextureDimension2D:8192}}),d=new Xn({width:340}),f={camera:"arcball",noiseSize:64,noiseType:"simplex3D"},g=document.createElement("canvas");document.getElementById("app").appendChild(g),g.width=window.innerWidth,g.height=window.innerHeight;const b=new fs(i,g),M=new bs({device:i,workgroupSizeX:256,cosmicNoiseOptions:{size:64,octaves:6,persistence:.6,scale:.02}});M.textures.cosmicNoise=Me(i,M.cosmicNoiseOptions.size,()=>we[f.noiseType](M.cosmicNoiseOptions)),d.add(f,"camera",["arcball","wasd"]).name("Camera type").onChange(()=>{b.setType(f.camera)}),d.add(f,"noiseSize",16,128,16).name("Noise size").onChange(()=>{M.initParticleDone=!1,M.cosmicNoiseOptions.size=f.noiseSize,M.textures.cosmicNoise=Me(i,M.cosmicNoiseOptions.size,()=>we[f.noiseType](M.cosmicNoiseOptions))}),d.add(f,"noiseType",Object.keys(we)).name("Noise type").onChange(()=>{M.initParticleDone=!1,M.textures.cosmicNoise=Me(i,M.cosmicNoiseOptions.size,()=>we[f.noiseType](M.cosmicNoiseOptions))});const A=d.add({restart(){M.initParticleDone=!1}},"restart").name("Restart simulation").domElement.previousSibling.style;A.textAlign="center",A.fontWeight="bold";async function T(){b.frame();const P=Le.create(M);M.initParticleDone||(await P.addKernel(new As(M)),M.initParticleDone=!0),await P.addKernel(new Ps(M)),await P.submit(),[M.textures.particlesTextureRead,M.textures.particlesTextureWrite]=[M.textures.particlesTextureWrite,M.textures.particlesTextureRead];const B=Be.create({context:M,canvas:g,camera:b});await B.addKernel(new ks(B)),await B.submit(),requestAnimationFrame(T)}T()}window.addEventListener("DOMContentLoaded",async()=>{await zs()});
